var p=(I,g,k)=>new Promise((_,b)=>{var C=d=>{try{i(k.next(d))}catch(a){b(a)}},h=d=>{try{i(k.throw(d))}catch(a){b(a)}},i=d=>d.done?_(d.value):Promise.resolve(d.value).then(C,h);i((k=k.apply(I,g)).next())});import{_ as K,r as u,e as W,g as X,c as o,b as t,d as m,i as Y,k as Z,q as ee,t as r,w as y,v as V,C as F,F as $,a as S,j as O,o as n,p as te,n as le}from"./index-BydkJMfL.js";import{O as se,P as oe,g as ne,Q as ae,R as ue,S as ie,T as de}from"./api-qDxNJde6.js";const re={class:"bookmark-manager"},ve={class:"header"},ce={class:"header-left"},fe={class:"bookmark-total"},pe={class:"header-right"},ke=["value"],me={key:0,class:"toolbar"},ye={key:1,class:"bookmark-list"},be=["checked","onChange"],ge=["src"],_e={class:"bookmark-info"},Ce=["href"],he={key:0,class:"bookmark-folder"},Me={class:"bookmark-url"},xe={class:"bookmark-actions"},Be=["onClick"],we=["onClick"],Ve={key:0,class:"empty-state"},$e={key:2,class:"loading"},Se={key:3,class:"pagination"},Te=["disabled"],Ue=["disabled"],Fe={class:"modal-content"},Ie=["value"],De=["value"],Ee={class:"modal-actions"},Ne=["disabled"],Oe={class:"modal-content"},ze={class:"form-group"},Qe={class:"form-group"},je={class:"form-group"},qe={class:"modal-actions"},z=50,Le={__name:"BookmarkManager",setup(I){const g=u([]),k=u([]),_=u([]),b=u(!0),C=u(""),h=u(""),i=u(1),d=u(0),a=u([]),M=u(!1),c=u(""),T=u(""),x=u(!1),v=u({id:null,title:"",url:"",folder:""}),B=W(()=>Math.ceil(d.value/z));let D=null;const Q=()=>{clearTimeout(D),D=setTimeout(()=>{i.value=1,f()},300)};function f(){return p(this,null,function*(){b.value=!0;try{const s=yield se({page:i.value,pageSize:z,folder:h.value||void 0,search:C.value||void 0});g.value=s.data.data,d.value=s.data.total}catch(s){console.error("åŠ è½½ä¹¦ç­¾å¤±è´¥:",s)}finally{b.value=!1}})}function j(){return p(this,null,function*(){try{const s=yield oe();k.value=s.data}catch(s){console.error("åŠ è½½æ–‡ä»¶å¤¹å¤±è´¥:",s)}})}function q(){return p(this,null,function*(){try{const s=yield ne();_.value=s.data}catch(s){console.error("åŠ è½½èœå•å¤±è´¥:",s)}})}function E(s){const e=_.value.find(U=>U.id===s);return(e==null?void 0:e.subMenus)||[]}function L(s){const e=a.value.indexOf(s);e>-1?a.value.splice(e,1):a.value.push(s)}function P(){a.value=[]}function R(s){return p(this,null,function*(){if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªä¹¦ç­¾å—ï¼Ÿ"))try{yield de(s),f()}catch(e){alert("åˆ é™¤å¤±è´¥")}})}function A(){return p(this,null,function*(){if(confirm(`ç¡®å®šåˆ é™¤é€‰ä¸­çš„ ${a.value.length} ä¸ªä¹¦ç­¾å—ï¼Ÿ`))try{yield ae(a.value),a.value=[],f()}catch(s){alert("åˆ é™¤å¤±è´¥")}})}function G(){return p(this,null,function*(){if(c.value)try{for(const s of a.value)yield ue(s,c.value,T.value||null);alert("è½¬æ¢æˆåŠŸ"),a.value=[],M.value=!1,f()}catch(s){alert("è½¬æ¢å¤±è´¥")}})}function H(s){v.value={id:s.id,title:s.title,url:s.url,folder:s.folder||""},x.value=!0}function J(){return p(this,null,function*(){try{yield ie(v.value.id,v.value),x.value=!1,f()}catch(s){alert("ä¿å­˜å¤±è´¥")}})}function N(s){s<1||s>B.value||(i.value=s,f())}return X(()=>{f(),j(),q()}),(s,e)=>{const U=ee("router-link");return n(),o("div",re,[t("div",ve,[t("div",ce,[Y(U,{to:"/",class:"back-btn"},{default:Z(()=>e[15]||(e[15]=[te("â† è¿”å›é¦–é¡µ")])),_:1,__:[15]}),e[16]||(e[16]=t("h1",null,"ğŸ“š ä¹¦ç­¾ç®¡ç†",-1)),t("span",fe,"å…± "+r(d.value)+" ä¸ªä¹¦ç­¾",1)]),t("div",pe,[y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>C.value=l),type:"text",placeholder:"æœç´¢ä¹¦ç­¾...",class:"search-input",onInput:Q},null,544),[[V,C.value]]),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>h.value=l),class:"folder-select",onChange:f},[e[17]||(e[17]=t("option",{value:""},"å…¨éƒ¨æ–‡ä»¶å¤¹",-1)),(n(!0),o($,null,S(k.value,l=>(n(),o("option",{key:l,value:l},r(l),9,ke))),128))],544),[[F,h.value]])])]),a.value.length>0?(n(),o("div",me,[t("span",null,"å·²é€‰æ‹© "+r(a.value.length)+" é¡¹",1),t("button",{onClick:A,class:"btn btn-danger"},"åˆ é™¤é€‰ä¸­"),t("button",{onClick:e[2]||(e[2]=l=>M.value=!0),class:"btn btn-primary"},"è½¬ä¸ºå¡ç‰‡"),t("button",{onClick:P,class:"btn btn-secondary"},"å–æ¶ˆé€‰æ‹©")])):m("",!0),b.value?(n(),o("div",$e,"åŠ è½½ä¸­...")):(n(),o("div",ye,[(n(!0),o($,null,S(g.value,l=>(n(),o("div",{key:l.id,class:le(["bookmark-item",{selected:a.value.includes(l.id)}])},[t("input",{type:"checkbox",checked:a.value.includes(l.id),onChange:w=>L(l.id)},null,40,be),t("img",{src:l.logo_url||"/default-favicon.png",class:"favicon",onError:e[3]||(e[3]=w=>w.target.src="/default-favicon.png")},null,40,ge),t("div",_e,[t("a",{href:l.url,target:"_blank",class:"bookmark-title"},r(l.title),9,Ce),l.folder?(n(),o("span",he,"ğŸ“ "+r(l.folder),1)):m("",!0),t("span",Me,r(l.url),1)]),t("div",xe,[t("button",{onClick:w=>H(l),class:"btn-icon",title:"ç¼–è¾‘"},"âœï¸",8,Be),t("button",{onClick:w=>R(l.id),class:"btn-icon",title:"åˆ é™¤"},"ğŸ—‘ï¸",8,we)])],2))),128)),g.value.length===0?(n(),o("div",Ve,e[18]||(e[18]=[t("p",null,"æš‚æ— ä¹¦ç­¾",-1),t("p",{class:"hint"},"ä½¿ç”¨æµè§ˆå™¨æ‰©å±•å¯¼å…¥ä¹¦ç­¾",-1)]))):m("",!0)])),B.value>1?(n(),o("div",Se,[t("button",{onClick:e[4]||(e[4]=l=>N(i.value-1)),disabled:i.value<=1},"ä¸Šä¸€é¡µ",8,Te),t("span",null,r(i.value)+" / "+r(B.value),1),t("button",{onClick:e[5]||(e[5]=l=>N(i.value+1)),disabled:i.value>=B.value},"ä¸‹ä¸€é¡µ",8,Ue)])):m("",!0),M.value?(n(),o("div",{key:4,class:"modal-overlay",onClick:e[9]||(e[9]=O(l=>M.value=!1,["self"]))},[t("div",Fe,[e[21]||(e[21]=t("h3",null,"è½¬æ¢ä¸ºå¡ç‰‡",-1)),e[22]||(e[22]=t("p",null,"é€‰æ‹©ç›®æ ‡åˆ†ç±»ï¼š",-1)),y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),class:"folder-select"},[e[19]||(e[19]=t("option",{value:""},"è¯·é€‰æ‹©åˆ†ç±»",-1)),(n(!0),o($,null,S(_.value,l=>(n(),o("option",{key:l.id,value:l.id},r(l.name),9,Ie))),128))],512),[[F,c.value]]),c.value&&E(c.value).length?y((n(),o("select",{key:0,"onUpdate:modelValue":e[7]||(e[7]=l=>T.value=l),class:"folder-select"},[e[20]||(e[20]=t("option",{value:""},"ä¸é€‰æ‹©å­åˆ†ç±»",-1)),(n(!0),o($,null,S(E(c.value),l=>(n(),o("option",{key:l.id,value:l.id},r(l.name),9,De))),128))],512)),[[F,T.value]]):m("",!0),t("div",Ee,[t("button",{onClick:e[8]||(e[8]=l=>M.value=!1),class:"btn btn-secondary"},"å–æ¶ˆ"),t("button",{onClick:G,class:"btn btn-primary",disabled:!c.value},"ç¡®è®¤è½¬æ¢",8,Ne)])])])):m("",!0),x.value?(n(),o("div",{key:5,class:"modal-overlay",onClick:e[14]||(e[14]=O(l=>x.value=!1,["self"]))},[t("div",Oe,[e[26]||(e[26]=t("h3",null,"ç¼–è¾‘ä¹¦ç­¾",-1)),t("div",ze,[e[23]||(e[23]=t("label",null,"æ ‡é¢˜",-1)),y(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>v.value.title=l),type:"text"},null,512),[[V,v.value.title]])]),t("div",Qe,[e[24]||(e[24]=t("label",null,"ç½‘å€",-1)),y(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>v.value.url=l),type:"url"},null,512),[[V,v.value.url]])]),t("div",je,[e[25]||(e[25]=t("label",null,"æ–‡ä»¶å¤¹",-1)),y(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>v.value.folder=l),type:"text"},null,512),[[V,v.value.folder]])]),t("div",qe,[t("button",{onClick:e[13]||(e[13]=l=>x.value=!1),class:"btn btn-secondary"},"å–æ¶ˆ"),t("button",{onClick:J,class:"btn btn-primary"},"ä¿å­˜")])])])):m("",!0)])}}},Ge=K(Le,[["__scopeId","data-v-6e372482"]]);export{Ge as default};
