var He=Object.defineProperty,je=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var Ae=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var Ie=(r,t,a)=>t in r?He(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,Y=(r,t)=>{for(var a in t||(t={}))Ge.call(t,a)&&Ie(r,a,t[a]);if(Ae)for(var a of Ae(t))Je.call(t,a)&&Ie(r,a,t[a]);return r},re=(r,t)=>je(r,qe(t));var x=(r,t,a)=>new Promise((C,l)=>{var u=n=>{try{D(a.next(n))}catch(c){l(c)}},I=n=>{try{D(a.throw(n))}catch(c){l(c)}},D=n=>n.done?C(n.value):Promise.resolve(n.value).then(u,I);D((a=a.apply(r,t)).next())});import{_ as J,c as i,b as o,f as e,t as d,A as ie,r as $,o as ne,d as A,k as _,v as W,m as xe,F as K,e as F,i as de,w as Be,B as oe,s as z,y as ke,h as we,g as E,C as ae,z as Ce,q as G,D as De,j as _e,E as Ue,G as ce,H as Re,a as Qe,l as Xe,T as Ye,I as Ze,J as et}from"./index-Uznwjh_G.js";import{g as Ve,m as tt,w as st,t as lt,u as nt,n as at,o as ot,c as Se,k as it,p as Le,x as Pe,f as rt,z as dt,A as ut,B as $e,C as ct,D as vt,E as pt,F as mt,i as be,b as ft,G as gt,H as ht,I as bt,J as yt,K as kt,L as wt,M as ze,N as Te,O as _t,P as Ct,Q as $t,R as Mt,S as xt,T as Tt,U as Ut}from"./urlNormalizer-BBFgLYjs.js";const Vt={class:"welcome-page"},St={class:"welcome-title"},At={class:"welcome-cards"},It={class:"welcome-card"},Bt={class:"welcome-value"},Dt={class:"welcome-card"},Lt={class:"welcome-value"},Pt={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(r){return(t,a)=>(o(),i("div",Vt,[e("h2",St,"æ¬¢è¿æ‚¨ï¼Œ"+d(r.currentUsername||"admin")+"ï¼",1),e("div",At,[e("div",It,[a[0]||(a[0]=ie('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",Bt,d(r.lastLoginTime||"--"),1)]),e("div",Dt,[a[1]||(a[1]=ie('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",Lt,d(r.lastLoginIp||"--"),1)])])]))}},Wt=J(Pt,[["__scopeId","data-v-5cc4f846"]]),Rt={class:"menu-manage"},zt={key:0,class:"loading-overlay"},Et={class:"menu-header"},Nt={class:"menu-add"},Kt=["disabled"],Ft={class:"menu-content"},Ot={key:0,class:"empty-state"},Ht={class:"menu-card-header"},jt={class:"menu-title"},qt={class:"menu-name"},Gt={class:"menu-order"},Jt={class:"menu-actions"},Qt=["onClick"],Xt=["onClick"],Yt=["onClick"],Zt={key:0,class:"sub-menu-list"},es={class:"sub-menu-name"},ts={class:"sub-menu-order"},ss={class:"sub-menu-actions"},ls=["onClick"],ns=["onClick"],as={key:1,class:"no-sub-menu"},os={key:1,class:"modal-overlay"},is={class:"modal"},rs={class:"modal-header"},ds={class:"modal-body"},us={class:"form-group"},cs={class:"form-group"},vs={class:"modal-footer"},ps=["disabled"],ms={key:2,class:"modal-overlay"},fs={class:"modal"},gs={class:"modal-header"},hs={class:"modal-body"},bs={class:"form-group"},ys={class:"form-group"},ks={class:"modal-footer"},ws=["disabled"],_s={key:3,class:"modal-overlay"},Cs={class:"modal"},$s={class:"modal-body"},Ms={class:"form-group"},xs={class:"form-group"},Ts={class:"modal-footer"},Us=["disabled"],Vs={__name:"MenuManage",setup(r){const t=$([]),a=$(!1),C=$("åŠ è½½ä¸­..."),l=$(""),u=$(!1),I=$(null),D=$({name:"",order:0}),n=$(!1),c=$(null),h=$(""),b=$({name:"",order:0}),U=$(!1),y=$(null),m=$({name:"",order:0});ne(()=>{v()});function f(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[æ ç›®ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(R){console.warn("[æ ç›®ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",R)}}function v(R=!1){return x(this,null,function*(){var w,B;a.value=!0,C.value="åŠ è½½ä¸­...";try{const L=yield Ve(!0);t.value=L.data||[],R&&f()}catch(L){alert("åŠ è½½å¤±è´¥: "+(((B=(w=L.response)==null?void 0:w.data)==null?void 0:B.error)||L.message))}finally{a.value=!1}})}function S(){return x(this,null,function*(){var R,w;if(l.value.trim()){a.value=!0,C.value="æ·»åŠ ä¸­...";try{const B=t.value.length?Math.max(...t.value.map(L=>L.order||0)):0;yield tt({name:l.value.trim(),order:B+1}),l.value="",yield v(!0)}catch(B){alert("æ·»åŠ å¤±è´¥: "+(((w=(R=B.response)==null?void 0:R.data)==null?void 0:w.error)||B.message)),a.value=!1}}})}function T(R){I.value=R,D.value={name:R.name,order:R.order},u.value=!0}function V(){return x(this,null,function*(){var L,g;if(!D.value.name.trim()||!I.value)return;const R=I.value.id,w=D.value.name.trim(),B=D.value.order;N(),a.value=!0,C.value="ä¿å­˜ä¸­...";try{yield nt(R,{name:w,order:B}),yield v(!0)}catch(p){alert("ä¿å­˜å¤±è´¥: "+(((g=(L=p.response)==null?void 0:L.data)==null?void 0:g.error)||p.message)),a.value=!1}})}function H(R){return x(this,null,function*(){var w,B;if(confirm(`ç¡®å®šåˆ é™¤ä¸»èœå•ã€Œ${R.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ï¼`)){a.value=!0,C.value="åˆ é™¤ä¸­...";try{yield st(R.id),yield v(!0)}catch(L){alert("åˆ é™¤å¤±è´¥: "+(((B=(w=L.response)==null?void 0:w.data)==null?void 0:B.error)||L.message)),a.value=!1}}})}function X(R){c.value=R.id,h.value=R.name;const w=R.subMenus||[],B=w.length?Math.max(...w.map(L=>L.order||0)):0;b.value={name:"",order:B+1},n.value=!0}function ee(){return x(this,null,function*(){var L,g;if(!b.value.name.trim()||!c.value)return;const R=c.value,w=b.value.name.trim(),B=b.value.order;N(),a.value=!0,C.value="æ·»åŠ ä¸­...";try{yield at(R,{name:w,order:B}),yield v(!0)}catch(p){alert("æ·»åŠ å¤±è´¥: "+(((g=(L=p.response)==null?void 0:L.data)==null?void 0:g.error)||p.message)),a.value=!1}})}function te(R,w){y.value=w,m.value={name:w.name,order:w.order},U.value=!0}function le(){return x(this,null,function*(){var L,g;if(!m.value.name.trim()||!y.value)return;const R=y.value.id,w=m.value.name.trim(),B=m.value.order;N(),a.value=!0,C.value="ä¿å­˜ä¸­...";try{yield ot(R,{name:w,order:B}),yield v(!0)}catch(p){alert("ä¿å­˜å¤±è´¥: "+(((g=(L=p.response)==null?void 0:L.data)==null?void 0:g.error)||p.message)),a.value=!1}})}function se(R){return x(this,null,function*(){var w,B;if(confirm(`ç¡®å®šåˆ é™¤å­èœå•ã€Œ${R.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å¡ç‰‡ï¼`)){a.value=!0,C.value="åˆ é™¤ä¸­...";try{yield lt(R.id),yield v(!0)}catch(L){alert("åˆ é™¤å¤±è´¥: "+(((B=(w=L.response)==null?void 0:w.data)==null?void 0:B.error)||L.message)),a.value=!1}}})}function N(){u.value=!1,n.value=!1,U.value=!1,I.value=null,y.value=null}return(R,w)=>(o(),i("div",Rt,[a.value?(o(),i("div",zt,[w[7]||(w[7]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,d(C.value),1)])):A("",!0),e("div",Et,[w[8]||(w[8]=e("h2",{class:"page-title"},"æ ç›®ç®¡ç†",-1)),e("div",Nt,[_(e("input",{"onUpdate:modelValue":w[0]||(w[0]=B=>l.value=B),placeholder:"è¾“å…¥ä¸»èœå•åç§°",class:"input",onKeyup:xe(S,["enter"])},null,544),[[W,l.value]]),e("button",{class:"btn btn-primary",onClick:S,disabled:a.value||!l.value.trim()}," + æ·»åŠ ä¸»èœå• ",8,Kt)])]),e("div",Ft,[t.value.length===0?(o(),i("div",Ot,[...w[9]||(w[9]=[e("p",null,"æš‚æ— èœå•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªä¸»èœå•",-1)])])):A("",!0),(o(!0),i(K,null,F(t.value,B=>(o(),i("div",{key:B.id,class:"menu-card"},[e("div",Ht,[e("div",jt,[e("span",qt,d(B.name),1),e("span",Gt,"æ’åº: "+d(B.order),1)]),e("div",Jt,[e("button",{class:"btn-icon btn-edit",onClick:L=>T(B),title:"ç¼–è¾‘"},[...w[10]||(w[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Qt),e("button",{class:"btn-icon btn-add",onClick:L=>X(B),title:"æ·»åŠ å­èœå•"},[...w[11]||(w[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1)])],8,Xt),e("button",{class:"btn-icon btn-delete",onClick:L=>H(B),title:"åˆ é™¤"},[...w[12]||(w[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Yt)])]),B.subMenus&&B.subMenus.length>0?(o(),i("div",Zt,[(o(!0),i(K,null,F(B.subMenus,L=>(o(),i("div",{key:L.id,class:"sub-menu-item"},[e("span",es,d(L.name),1),e("span",ts,"æ’åº: "+d(L.order),1),e("div",ss,[e("button",{class:"btn-icon-sm btn-edit",onClick:g=>te(B,L),title:"ç¼–è¾‘"},[...w[13]||(w[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ls),e("button",{class:"btn-icon-sm btn-delete",onClick:g=>se(L),title:"åˆ é™¤"},[...w[14]||(w[14]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,ns)])]))),128))])):(o(),i("div",as,[...w[15]||(w[15]=[e("span",null,"æš‚æ— å­èœå•",-1)])]))]))),128))]),u.value?(o(),i("div",os,[e("div",is,[e("div",rs,[e("h3",null,d(I.value?"ç¼–è¾‘ä¸»èœå•":"æ·»åŠ å­èœå•"),1),e("button",{class:"modal-close",onClick:N},"Ã—")]),e("div",ds,[e("div",us,[w[16]||(w[16]=e("label",null,"åç§°",-1)),_(e("input",{"onUpdate:modelValue":w[1]||(w[1]=B=>D.value.name=B),type:"text",class:"input",placeholder:"è¯·è¾“å…¥åç§°"},null,512),[[W,D.value.name]])]),e("div",cs,[w[17]||(w[17]=e("label",null,"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":w[2]||(w[2]=B=>D.value.order=B),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[W,D.value.order,void 0,{number:!0}]])])]),e("div",vs,[e("button",{class:"btn btn-cancel",onClick:N},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:V,disabled:!D.value.name.trim()},"ä¿å­˜",8,ps)])])])):A("",!0),n.value?(o(),i("div",ms,[e("div",fs,[e("div",gs,[e("h3",null,"æ·»åŠ å­èœå•åˆ°ã€Œ"+d(h.value)+"ã€",1),e("button",{class:"modal-close",onClick:N},"Ã—")]),e("div",hs,[e("div",bs,[w[18]||(w[18]=e("label",null,"å­èœå•åç§°",-1)),_(e("input",{"onUpdate:modelValue":w[3]||(w[3]=B=>b.value.name=B),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[W,b.value.name]])]),e("div",ys,[w[19]||(w[19]=e("label",null,"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":w[4]||(w[4]=B=>b.value.order=B),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[W,b.value.order,void 0,{number:!0}]])])]),e("div",ks,[e("button",{class:"btn btn-cancel",onClick:N},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ee,disabled:!b.value.name.trim()},"æ·»åŠ ",8,ws)])])])):A("",!0),U.value?(o(),i("div",_s,[e("div",Cs,[e("div",{class:"modal-header"},[w[20]||(w[20]=e("h3",null,"ç¼–è¾‘å­èœå•",-1)),e("button",{class:"modal-close",onClick:N},"Ã—")]),e("div",$s,[e("div",Ms,[w[21]||(w[21]=e("label",null,"å­èœå•åç§°",-1)),_(e("input",{"onUpdate:modelValue":w[5]||(w[5]=B=>m.value.name=B),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[W,m.value.name]])]),e("div",xs,[w[22]||(w[22]=e("label",null,"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":w[6]||(w[6]=B=>m.value.order=B),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[W,m.value.order,void 0,{number:!0}]])])]),e("div",Ts,[e("button",{class:"btn btn-cancel",onClick:N},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:le,disabled:!m.value.name.trim()},"ä¿å­˜",8,Us)])])])):A("",!0)]))}},Ss=J(Vs,[["__scopeId","data-v-7671c3a1"]]),As={class:"card-manage"},Is={class:"card-header"},Bs={class:"card-add"},Ds=["value"],Ls=["value"],Ps={class:"card-card"},Ws={class:"card-table"},Rs=["onUpdate:modelValue","onBlur"],zs=["onUpdate:modelValue","onBlur"],Es=["onUpdate:modelValue","onBlur"],Ns=["onUpdate:modelValue","onBlur"],Ks=["onClick"],Fs={key:0,class:"selected-tags"},Os={key:1,class:"tag-placeholder"},Hs=["onUpdate:modelValue","onBlur"],js=["onClick"],qs={class:"modal-body"},Gs={key:0,class:"empty-tags"},Js={key:1,class:"tag-options"},Qs=["checked","onChange"],Xs={class:"modal-body"},Ys={class:"duplicate-comparison"},Zs={class:"card-info-box existing"},el={class:"card-details"},tl={class:"detail-row"},sl={class:"detail-value"},ll={class:"detail-row"},nl={class:"detail-value url"},al={key:0,class:"detail-row"},ol={class:"detail-value url"},il={class:"card-info-box pending"},rl={class:"card-details"},dl={class:"detail-row"},ul={class:"detail-value"},cl={class:"detail-row"},vl={class:"detail-value url"},pl={key:0,class:"detail-row"},ml={class:"detail-value url"},fl={__name:"CardManage",setup(r){const t=$([]),a=$([]),C=$(),l=$(""),u=$(""),I=$(""),D=$(""),n=$([]),c=$(!1),h=$(null),b=$([]),U=$(!1),y=$(null),m=$(null),f=de(()=>{if(!C.value)return[];const g=t.value.find(p=>p.id===C.value);return(g==null?void 0:g.subMenus)||[]});ne(()=>x(null,null,function*(){const g=yield Ve();t.value=g.data,t.value.length&&(C.value=t.value[0].id,l.value="");const p=yield Se();n.value=p.data})),Be(C,()=>{l.value="",T()}),Be(l,T);function v(){l.value=""}function S(){T()}function T(){return x(this,null,function*(){if(!C.value)return;const g=yield rt(C.value,l.value||null);a.value=g.data})}function V(){return x(this,null,function*(){if(!u.value||!I.value)return;const g=a.value.find(p=>it({title:u.value,url:I.value},p));g?(y.value=g,m.value={menu_id:C.value,sub_menu_id:l.value||null,title:u.value,url:I.value,logo_url:D.value},U.value=!0):yield N({menu_id:C.value,sub_menu_id:l.value||null,title:u.value,url:I.value,logo_url:D.value})})}function H(g){return x(this,null,function*(){yield Le(g.id,{menu_id:C.value,sub_menu_id:l.value||null,title:g.title,url:g.url,logo_url:g.logo_url,desc:g.desc,order:g.order,tagIds:g.tags?g.tags.map(p=>p.id):[]}),T()})}function X(g){return x(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const p=a.value.findIndex(Q=>Q.id===g);p>-1&&a.value.splice(p,1);try{yield Pe(g)}catch(Q){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",Q),yield T()}})}function ee(g){h.value=g,b.value=g.tags?g.tags.map(p=>p.id):[],c.value=!0}function te(){c.value=!1,h.value=null,b.value=[]}function le(g){const p=b.value.indexOf(g);p>-1?b.value.splice(p,1):b.value.push(g)}function se(){return x(this,null,function*(){h.value&&(yield Le(h.value.id,{menu_id:h.value.menu_id,sub_menu_id:h.value.sub_menu_id,title:h.value.title,url:h.value.url,logo_url:h.value.logo_url,desc:h.value.desc,order:h.value.order,tagIds:b.value}),te(),T())})}function N(g){return x(this,null,function*(){yield dt(g),u.value="",I.value="",D.value="",T()})}function R(){U.value=!1,y.value=null,m.value=null}function w(){R(),u.value="",I.value="",D.value=""}function B(){return x(this,null,function*(){!m.value||!y.value||(yield Pe(y.value.id),yield N(m.value),R())})}function L(){m.value&&(u.value=m.value.title,I.value=m.value.url,D.value=m.value.logo_url||"",R(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(g,p)=>{var Q,ve,pe,me,fe,Z,ge,he;return o(),i("div",As,[e("div",Is,[p[9]||(p[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",Bs,[_(e("select",{"onUpdate:modelValue":p[0]||(p[0]=P=>C.value=P),class:"input narrow",onChange:v},[(o(!0),i(K,null,F(t.value,P=>(o(),i("option",{value:P.id,key:P.id},d(P.name),9,Ds))),128))],544),[[oe,C.value]]),_(e("select",{"onUpdate:modelValue":p[1]||(p[1]=P=>l.value=P),class:"input narrow",onChange:S},[p[7]||(p[7]=e("option",{value:""},"ä¸»èœå•",-1)),(o(!0),i(K,null,F(f.value,P=>(o(),i("option",{value:P.id,key:P.id},d(P.name),9,Ls))),128))],544),[[oe,l.value]]),_(e("input",{"onUpdate:modelValue":p[2]||(p[2]=P=>u.value=P),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[W,u.value]]),_(e("input",{"onUpdate:modelValue":p[3]||(p[3]=P=>I.value=P),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[W,I.value]]),_(e("input",{"onUpdate:modelValue":p[4]||(p[4]=P=>D.value=P),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[W,D.value]]),e("button",{class:"btn",onClick:V},[...p[8]||(p[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",Ps,[e("table",Ws,[p[11]||(p[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),i(K,null,F(a.value,P=>(o(),i("tr",{key:P.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":O=>P.title=O,onBlur:O=>H(P),class:"table-input"},null,40,Rs),[[W,P.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":O=>P.url=O,onBlur:O=>H(P),class:"table-input"},null,40,zs),[[W,P.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":O=>P.logo_url=O,onBlur:O=>H(P),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Es),[[W,P.logo_url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":O=>P.desc=O,onBlur:O=>H(P),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,Ns),[[W,P.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:O=>ee(P)},[P.tags&&P.tags.length>0?(o(),i("div",Fs,[(o(!0),i(K,null,F(P.tags,O=>(o(),i("span",{key:O.id,class:"mini-tag",style:ke({backgroundColor:O.color})},d(O.name),5))),128))])):(o(),i("span",Os,"é€‰æ‹©æ ‡ç­¾"))],8,Ks)]),e("td",null,[_(e("input",{"onUpdate:modelValue":O=>P.order=O,type:"number",onBlur:O=>H(P),class:"table-input order-input"},null,40,Hs),[[W,P.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:O=>X(P.id),title:"åˆ é™¤"},[...p[10]||(p[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,js)])]))),128))])])]),c.value?(o(),i("div",{key:0,class:"modal-overlay",onClick:te},[e("div",{class:"modal-content",onClick:p[5]||(p[5]=we(()=>{},["stop"]))},[e("div",{class:"modal-header"},[p[12]||(p[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:te},"Ã—")]),e("div",qs,[n.value.length===0?(o(),i("div",Gs,[...p[13]||(p[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(o(),i("div",Js,[(o(!0),i(K,null,F(n.value,P=>(o(),i("label",{key:P.id,class:"tag-option"},[e("input",{type:"checkbox",checked:b.value.includes(P.id),onChange:O=>le(P.id)},null,40,Qs),e("span",{class:"tag-label",style:ke({backgroundColor:P.color})},d(P.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:te},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se},"ç¡®å®š")])])])):A("",!0),U.value?(o(),i("div",{key:1,class:"modal-overlay",onClick:R},[e("div",{class:"modal-content duplicate-modal",onClick:p[6]||(p[6]=we(()=>{},["stop"]))},[e("div",{class:"modal-header"},[p[14]||(p[14]=ie('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:R},"Ã—")]),e("div",Xs,[p[24]||(p[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",Ys,[e("div",Zs,[p[18]||(p[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",el,[e("div",tl,[p[15]||(p[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",sl,d((Q=y.value)==null?void 0:Q.title),1)]),e("div",ll,[p[16]||(p[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",nl,d((ve=y.value)==null?void 0:ve.url),1)]),(pe=y.value)!=null&&pe.logo_url?(o(),i("div",al,[p[17]||(p[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",ol,d((me=y.value)==null?void 0:me.logo_url),1)])):A("",!0)])]),p[23]||(p[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",il,[p[22]||(p[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",rl,[e("div",dl,[p[19]||(p[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",ul,d((fe=m.value)==null?void 0:fe.title),1)]),e("div",cl,[p[20]||(p[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",vl,d((Z=m.value)==null?void 0:Z.url),1)]),(ge=m.value)!=null&&ge.logo_url?(o(),i("div",pl,[p[21]||(p[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",ml,d((he=m.value)==null?void 0:he.logo_url),1)])):A("",!0)])])]),p[25]||(p[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:w},[...p[26]||(p[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),z(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:B},[...p[27]||(p[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),z(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:L},[...p[28]||(p[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),z(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):A("",!0)])}}},gl=J(fl,[["__scopeId","data-v-edd548d5"]]),hl={class:"duplicate-manage"},bl={class:"section-header"},yl=["disabled"],kl={key:0,class:"duplicate-results"},wl={class:"result-summary"},_l={class:"summary-card"},Cl={class:"summary-value"},$l={class:"summary-card warning"},Ml={class:"summary-value"},xl={class:"summary-card danger"},Tl={class:"summary-value"},Ul={class:"duplicate-groups"},Vl={class:"group-header"},Sl={class:"group-count"},Al={class:"card-item original"},Il={class:"card-info"},Bl={class:"card-title"},Dl={class:"card-url"},Ll={key:0,class:"card-desc"},Pl={class:"card-id"},Wl={class:"duplicates-list"},Rl={class:"card-info"},zl={class:"card-title"},El={class:"card-url"},Nl={key:0,class:"card-desc"},Kl={class:"card-actions"},Fl={class:"card-id"},Ol=["onClick","disabled"],Hl={class:"group-actions"},jl=["onClick","disabled"],ql={class:"global-actions"},Gl=["disabled"],Jl={key:1,class:"no-duplicates"},Ql={key:2,class:"initial-hint"},Xl={key:3,class:"error"},Yl={__name:"DuplicateManage",setup(r){const t=$(!1),a=$(!1),C=$(!1),l=$([]),u=$(0),I=$(0),D=$("");function n(){return x(this,null,function*(){var U,y;t.value=!0,D.value="";try{const m=yield ut();u.value=m.data.total,l.value=m.data.duplicateGroups,I.value=m.data.duplicateCount,C.value=!0}catch(m){D.value=((y=(U=m.response)==null?void 0:U.data)==null?void 0:y.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",m)}finally{t.value=!1}})}function c(U){return x(this,null,function*(){var y,m,f;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){a.value=!0,D.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",U);const v=yield $e([U]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",v.data),v.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield n()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(v.data.message||"æœªçŸ¥é”™è¯¯")}catch(v){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",v),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(y=v.response)==null?void 0:y.data),D.value=((f=(m=v.response)==null?void 0:m.data)==null?void 0:f.error)||v.message||"åˆ é™¤å¤±è´¥"}finally{a.value=!1}}})}function h(U){return x(this,null,function*(){var m,f,v;const y=U.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${y} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${U.original.title}`)){a.value=!0,D.value="";try{const S=U.duplicates.map(V=>V.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",S);const T=yield $e(S);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",T.data),T.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield n()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(T.data.message||"æœªçŸ¥é”™è¯¯")}catch(S){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",S),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(m=S.response)==null?void 0:m.data),D.value=((v=(f=S.response)==null?void 0:f.data)==null?void 0:v.error)||S.message||"åˆ é™¤å¤±è´¥"}finally{a.value=!1}}})}function b(){return x(this,null,function*(){var y,m,f;const U=I.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${U} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){a.value=!0,D.value="";try{const v=l.value.flatMap(T=>T.duplicates.map(V=>V.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",v);const S=yield $e(v);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",S.data),S.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield n()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(S.data.message||"æœªçŸ¥é”™è¯¯")}catch(v){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",v),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(y=v.response)==null?void 0:y.data),D.value=((f=(m=v.response)==null?void 0:m.data)==null?void 0:f.error)||v.message||"åˆ é™¤å¤±è´¥"}finally{a.value=!1}}})}return(U,y)=>(o(),i("div",hl,[e("div",bl,[y[0]||(y[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:n,class:"btn btn-primary",disabled:t.value},d(t.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,yl)]),l.value.length>0?(o(),i("div",kl,[e("div",wl,[e("div",_l,[y[1]||(y[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",Cl,d(u.value),1)]),e("div",$l,[y[2]||(y[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",Ml,d(l.value.length),1)]),e("div",xl,[y[3]||(y[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",Tl,d(I.value),1)])]),e("div",Ul,[(o(!0),i(K,null,F(l.value,(m,f)=>(o(),i("div",{key:f,class:"duplicate-group"},[e("div",Vl,[e("h4",null,"é‡å¤ç»„ "+d(f+1),1),e("span",Sl,d(m.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",Al,[y[4]||(y[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",Il,[e("div",Bl,d(m.original.title),1),e("div",Dl,d(m.original.url),1),m.original.desc?(o(),i("div",Ll,d(m.original.desc),1)):A("",!0)]),e("div",Pl,"ID: "+d(m.original.id),1)]),e("div",Wl,[(o(!0),i(K,null,F(m.duplicates,v=>(o(),i("div",{key:v.id,class:"card-item duplicate"},[y[5]||(y[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",Rl,[e("div",zl,d(v.title),1),e("div",El,d(v.url),1),v.desc?(o(),i("div",Nl,d(v.desc),1)):A("",!0)]),e("div",Kl,[e("span",Fl,"ID: "+d(v.id),1),e("button",{onClick:S=>c(v.id),class:"btn-remove",disabled:a.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,Ol)])]))),128))]),e("div",Hl,[e("button",{onClick:v=>h(m),class:"btn btn-danger",disabled:a.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+d(m.duplicates.length)+" å¼ ) ",9,jl)])]))),128))]),e("div",ql,[e("button",{onClick:b,class:"btn btn-danger btn-large",disabled:a.value},d(a.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${I.value} å¼ )`),9,Gl)])])):C.value&&l.value.length===0?(o(),i("div",Jl,[...y[6]||(y[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):C.value?A("",!0):(o(),i("div",Ql,[...y[7]||(y[7]=[ie('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),D.value?(o(),i("p",Xl,d(D.value),1)):A("",!0)]))}},Zl=J(Yl,[["__scopeId","data-v-62bbc778"]]),en={class:"tag-manage"},tn={class:"tag-header"},sn={class:"tag-add"},ln={class:"tag-content"},nn={key:0,class:"empty-state"},an={key:1,class:"tag-list"},on={class:"tag-info"},rn=["onUpdate:modelValue","onBlur"],dn={class:"tag-stats"},un={class:"card-count"},cn={class:"tag-controls"},vn=["onUpdate:modelValue","onChange"],pn={class:"tag-order"},mn=["onUpdate:modelValue","onBlur"],fn={class:"tag-actions"},gn=["onClick"],hn={__name:"TagManage",setup(r){const t=$([]),a=$(""),C=$("#2566d8");ne(l);function l(){return x(this,null,function*(){const n=yield Se();t.value=n.data;for(const c of t.value)try{const h=yield ct(c.id);c.cardCount=h.data.count}catch(h){c.cardCount=0}})}function u(){return x(this,null,function*(){var U,y;if(!a.value.trim())return;const n=t.value.length?Math.max(...t.value.map(m=>m.order||0)):0,c=a.value.trim(),h=C.value,b={id:Date.now(),name:c,color:h,order:n+1,cardCount:0,_temp:!0};t.value.push(b),a.value="",C.value="#2566d8";try{const m=yield vt({name:c,color:h,order:n+1}),f=t.value.findIndex(v=>v.id===b.id);f>-1&&(t.value[f]=re(Y({},m.data),{cardCount:0}))}catch(m){const f=t.value.findIndex(v=>v.id===b.id);f>-1&&t.value.splice(f,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((y=(U=m.response)==null?void 0:U.data)==null?void 0:y.error)||m.message))}})}function I(n){return x(this,null,function*(){var c,h;if(!n._temp)try{yield pt(n.id,{name:n.name,color:n.color,order:n.order})}catch(b){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((h=(c=b.response)==null?void 0:c.data)==null?void 0:h.error)||b.message)),l()}})}function D(n){return x(this,null,function*(){var U,y;const c=t.value.find(m=>m.id===n);if(!c)return;const h=c.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${c.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${c.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${c.name}"å—ï¼Ÿ`;if(!confirm(h))return;const b=t.value.findIndex(m=>m.id===n);b>-1&&t.value.splice(b,1);try{yield mt(n)}catch(m){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((y=(U=m.response)==null?void 0:U.data)==null?void 0:y.error)||m.message)),l()}})}return(n,c)=>(o(),i("div",en,[e("div",tn,[c[3]||(c[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",sn,[_(e("input",{"onUpdate:modelValue":c[0]||(c[0]=h=>a.value=h),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[W,a.value]]),_(e("input",{"onUpdate:modelValue":c[1]||(c[1]=h=>C.value=h),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[W,C.value]]),e("button",{class:"btn btn-primary",onClick:u},[...c[2]||(c[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",ln,[t.value.length===0?(o(),i("div",nn,[...c[4]||(c[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(o(),i("div",an,[(o(!0),i(K,null,F(t.value,h=>(o(),i("div",{key:h.id,class:"tag-item"},[e("div",{class:"tag-preview",style:ke({backgroundColor:h.color})},[...c[5]||(c[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",on,[_(e("input",{"onUpdate:modelValue":b=>h.name=b,onBlur:b=>I(h),class:"tag-name-input",maxlength:"20"},null,40,rn),[[W,h.name]]),e("div",dn,[e("span",un,d(h.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",cn,[_(e("input",{"onUpdate:modelValue":b=>h.color=b,type:"color",onChange:b=>I(h),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,vn),[[W,h.color]]),e("div",pn,[c[6]||(c[6]=e("span",{class:"order-label"},"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":b=>h.order=b,type:"number",onBlur:b=>I(h),class:"order-input"},null,40,mn),[[W,h.order,void 0,{number:!0}]])])]),e("div",fn,[e("button",{class:"btn btn-danger btn-icon",onClick:b=>D(h.id),title:"åˆ é™¤æ ‡ç­¾"},[...c[7]||(c[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,gn)])]))),128))]))])]))}},bn=J(hn,[["__scopeId","data-v-56efcb56"]]),yn={class:"promo-manage"},kn={key:0,class:"loading-overlay"},wn={class:"promo-header"},_n={class:"promo-form"},Cn=["disabled"],$n={class:"promo-section"},Mn={class:"promo-list"},xn={key:0,class:"empty-state"},Tn={class:"promo-preview"},Un=["src"],Vn={class:"promo-info"},Sn={class:"promo-field"},An=["onUpdate:modelValue","onBlur"],In={class:"promo-field"},Bn=["onUpdate:modelValue","onBlur"],Dn={class:"promo-actions"},Ln=["onClick"],Pn={class:"promo-section"},Wn={class:"promo-list"},Rn={key:0,class:"empty-state"},zn={class:"promo-preview"},En=["src"],Nn={class:"promo-info"},Kn={class:"promo-field"},Fn=["onUpdate:modelValue","onBlur"],On={class:"promo-field"},Hn=["onUpdate:modelValue","onBlur"],jn={class:"promo-actions"},qn=["onClick"],ye="/api",Gn={__name:"PromoManage",setup(r){const t=()=>localStorage.getItem("token")||"",a=()=>({Authorization:`Bearer ${t()}`}),C=$([]),l=$(!1),u=$("åŠ è½½ä¸­..."),I=$({img:"",url:"",position:"left"}),D=de(()=>C.value.filter(m=>m.position==="left")),n=de(()=>C.value.filter(m=>m.position==="right"));ne(()=>{c()});function c(){return x(this,null,function*(){var m,f;l.value=!0,u.value="åŠ è½½ä¸­...";try{const v=yield be.get(`${ye}/promos`);let S=[];Array.isArray(v.data)?S=v.data:v.data&&Array.isArray(v.data.data)&&(S=v.data.data),C.value=S}catch(v){console.error("åŠ è½½å®£ä¼ å¤±è´¥:",v),alert("åŠ è½½å®£ä¼ å¤±è´¥: "+(((f=(m=v.response)==null?void 0:m.data)==null?void 0:f.error)||v.message))}finally{l.value=!1}})}function h(){return x(this,null,function*(){var m,f;if(!I.value.img||!I.value.url){alert("è¯·å¡«å†™å®£ä¼ å›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}l.value=!0,u.value="æ·»åŠ ä¸­...";try{yield be.post(`${ye}/promos`,I.value,{headers:a()}),I.value={img:"",url:"",position:"left"},yield c()}catch(v){alert("æ·»åŠ å¤±è´¥: "+(((f=(m=v.response)==null?void 0:m.data)==null?void 0:f.error)||v.message)),l.value=!1}})}function b(m){return x(this,null,function*(){var f,v;try{yield be.put(`${ye}/promos/${m.id}`,{img:m.img,url:m.url},{headers:a()})}catch(S){alert("æ›´æ–°å¤±è´¥: "+(((v=(f=S.response)==null?void 0:f.data)==null?void 0:v.error)||S.message)),yield c()}})}function U(m){return x(this,null,function*(){var f,v;if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªå®£ä¼ å—ï¼Ÿ")){l.value=!0,u.value="åˆ é™¤ä¸­...";try{yield be.delete(`${ye}/promos/${m.id}`,{headers:a()}),yield c()}catch(S){alert("åˆ é™¤å¤±è´¥: "+(((v=(f=S.response)==null?void 0:f.data)==null?void 0:v.error)||S.message)),l.value=!1}}})}function y(m){m.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="60"><rect fill="%23f0f0f0" width="100" height="60"/><text x="50" y="35" text-anchor="middle" fill="%23999" font-size="12">å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'}return(m,f)=>(o(),i("div",yn,[l.value?(o(),i("div",kn,[f[3]||(f[3]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,d(u.value),1)])):A("",!0),e("div",wn,[f[5]||(f[5]=e("h2",{class:"page-title"},"å®£ä¼ ç®¡ç†",-1)),e("div",_n,[_(e("input",{"onUpdate:modelValue":f[0]||(f[0]=v=>I.value.img=v),placeholder:"å®£ä¼ å›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[W,I.value.img]]),_(e("input",{"onUpdate:modelValue":f[1]||(f[1]=v=>I.value.url=v),placeholder:"å®£ä¼ è·³è½¬é“¾æ¥",class:"input"},null,512),[[W,I.value.url]]),_(e("select",{"onUpdate:modelValue":f[2]||(f[2]=v=>I.value.position=v),class:"input select"},[...f[4]||(f[4]=[e("option",{value:"left"},"å·¦ä¾§å®£ä¼ ",-1),e("option",{value:"right"},"å³ä¾§å®£ä¼ ",-1)])],512),[[oe,I.value.position]]),e("button",{class:"btn btn-primary",onClick:h,disabled:!I.value.img||!I.value.url}," + æ·»åŠ å®£ä¼  ",8,Cn)])]),e("div",$n,[f[8]||(f[8]=e("h3",{class:"section-title"},"ğŸ“ å·¦ä¾§å®£ä¼ ",-1)),e("div",Mn,[D.value.length===0?(o(),i("div",xn,"æš‚æ— å·¦ä¾§å®£ä¼ ")):A("",!0),(o(!0),i(K,null,F(D.value,v=>(o(),i("div",{key:v.id,class:"promo-card"},[e("div",Tn,[e("img",{src:v.img,alt:"å®£ä¼ å›¾ç‰‡",onError:y},null,40,Un)]),e("div",Vn,[e("div",Sn,[f[6]||(f[6]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),_(e("input",{"onUpdate:modelValue":S=>v.img=S,class:"input",onBlur:S=>b(v)},null,40,An),[[W,v.img]])]),e("div",In,[f[7]||(f[7]=e("label",null,"è·³è½¬é“¾æ¥",-1)),_(e("input",{"onUpdate:modelValue":S=>v.url=S,class:"input",onBlur:S=>b(v)},null,40,Bn),[[W,v.url]])])]),e("div",Dn,[e("button",{class:"btn btn-danger",onClick:S=>U(v)},"åˆ é™¤",8,Ln)])]))),128))])]),e("div",Pn,[f[11]||(f[11]=e("h3",{class:"section-title"},"ğŸ“ å³ä¾§å®£ä¼ ",-1)),e("div",Wn,[n.value.length===0?(o(),i("div",Rn,"æš‚æ— å³ä¾§å®£ä¼ ")):A("",!0),(o(!0),i(K,null,F(n.value,v=>(o(),i("div",{key:v.id,class:"promo-card"},[e("div",zn,[e("img",{src:v.img,alt:"å®£ä¼ å›¾ç‰‡",onError:y},null,40,En)]),e("div",Nn,[e("div",Kn,[f[9]||(f[9]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),_(e("input",{"onUpdate:modelValue":S=>v.img=S,class:"input",onBlur:S=>b(v)},null,40,Fn),[[W,v.img]])]),e("div",On,[f[10]||(f[10]=e("label",null,"è·³è½¬é“¾æ¥",-1)),_(e("input",{"onUpdate:modelValue":S=>v.url=S,class:"input",onBlur:S=>b(v)},null,40,Hn),[[W,v.url]])])]),e("div",jn,[e("button",{class:"btn btn-danger",onClick:S=>U(v)},"åˆ é™¤",8,qn)])]))),128))])])]))}},Jn=J(Gn,[["__scopeId","data-v-0221fbc3"]]),Qn={class:"friend-manage"},Xn={class:"friend-add"},Yn={class:"friend-card"},Zn={class:"friend-table"},ea=["onUpdate:modelValue","onBlur"],ta=["onUpdate:modelValue","onBlur"],sa=["onUpdate:modelValue","onBlur"],la=["onClick"],na={__name:"FriendLinkManage",setup(r){const t=$([]),a=$(""),C=$(""),l=$("");ne(u);function u(){return x(this,null,function*(){const c=yield ft();t.value=c.data})}function I(){return x(this,null,function*(){!a.value||!C.value||(yield gt({title:a.value,url:C.value,logo:l.value}),a.value="",C.value="",l.value="",u())})}function D(c){return x(this,null,function*(){yield ht(c.id,{title:c.title,url:c.url,logo:c.logo}),u()})}function n(c){return x(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const h=t.value.findIndex(b=>b.id===c);h>-1&&t.value.splice(h,1);try{yield bt(c)}catch(b){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",b),yield u()}})}return(c,h)=>(o(),i("div",Qn,[h[4]||(h[4]=e("div",{class:"friend-header"},null,-1)),e("div",Xn,[_(e("input",{"onUpdate:modelValue":h[0]||(h[0]=b=>a.value=b),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[W,a.value]]),_(e("input",{"onUpdate:modelValue":h[1]||(h[1]=b=>C.value=b),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[W,C.value]]),_(e("input",{"onUpdate:modelValue":h[2]||(h[2]=b=>l.value=b),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[W,l.value]]),e("button",{class:"btn",onClick:I},"æ·»åŠ å‹é“¾")]),e("div",Yn,[e("table",Zn,[h[3]||(h[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),i(K,null,F(t.value,b=>(o(),i("tr",{key:b.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":U=>b.title=U,onBlur:U=>D(b),class:"input"},null,40,ea),[[W,b.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":U=>b.url=U,onBlur:U=>D(b),class:"input"},null,40,ta),[[W,b.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":U=>b.logo=U,onBlur:U=>D(b),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,sa),[[W,b.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:U=>n(b.id)},"åˆ é™¤",8,la)])]))),128))])])])]))}},aa=J(na,[["__scopeId","data-v-c25e838c"]]),oa={class:"user-manage"},ia={class:"user-card"},ra={class:"username-section"},da={class:"username-form"},ua={class:"current-username"},ca={class:"username-display"},va={class:"form-group"},pa={class:"form-actions"},ma=["disabled"],fa={class:"password-section"},ga={class:"password-form"},ha={class:"form-group"},ba={class:"form-group"},ya={class:"form-group"},ka={class:"form-actions"},wa=["disabled"],_a={__name:"UserManage",setup(r){const t=$(""),a=$(""),C=$(""),l=$(!1),u=$(""),I=$("success"),D=$({}),n=$(""),c=$(!1),h=$(""),b=$("success");ne(()=>x(null,null,function*(){yield U()}));function U(){return x(this,null,function*(){try{const S=yield yt();D.value=S.data.data||S.data}catch(S){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",S)}})}function y(){return x(this,null,function*(){var S,T;if(!n.value){m("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(n.value.length<3||n.value.length>20){m("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(n.value===D.value.username){m("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}c.value=!0,h.value="";try{yield kt(n.value),m("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),n.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(V){m(((T=(S=V.response)==null?void 0:S.data)==null?void 0:T.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{c.value=!1}})}function m(S,T){h.value=S,b.value=T,setTimeout(()=>{h.value=""},3e3)}function f(){return x(this,null,function*(){var S,T;if(!t.value||!a.value||!C.value){v("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(a.value!==C.value){v("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(a.value.length<6){v("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}l.value=!0,u.value="";try{yield wt(t.value,a.value),v("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),t.value="",a.value="",C.value=""}catch(V){v(((T=(S=V.response)==null?void 0:S.data)==null?void 0:T.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{l.value=!1}})}function v(S,T){u.value=S,I.value=T,S==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&T==="success"?setTimeout(()=>{u.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{u.value=""},3e3)}return(S,T)=>(o(),i("div",oa,[T[11]||(T[11]=e("div",{class:"user-header"},null,-1)),e("div",ia,[e("div",ra,[T[6]||(T[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",da,[e("div",ua,[T[4]||(T[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",ca,d(D.value.username||"admin"),1)]),e("div",va,[T[5]||(T[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),_(e("input",{"onUpdate:modelValue":T[0]||(T[0]=V=>n.value=V),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[W,n.value]])]),e("div",pa,[e("button",{onClick:y,class:"btn",disabled:c.value},d(c.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,ma)]),h.value?(o(),i("p",{key:0,class:E(["message",b.value])},d(h.value),3)):A("",!0)])]),e("div",fa,[T[10]||(T[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",ga,[e("div",ha,[T[7]||(T[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":T[1]||(T[1]=V=>t.value=V),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[W,t.value]])]),e("div",ba,[T[8]||(T[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":T[2]||(T[2]=V=>a.value=V),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[W,a.value]])]),e("div",ya,[T[9]||(T[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":T[3]||(T[3]=V=>C.value=V),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[W,C.value]])]),e("div",ka,[e("button",{onClick:f,class:"btn",disabled:l.value},d(l.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,wa)]),u.value?(o(),i("p",{key:0,class:E(["message",I.value])},d(u.value),3)):A("",!0)])])])]))}},Ca=J(_a,[["__scopeId","data-v-40392133"]]),$a={class:"backup-manage"},Ma={class:"tabs"},xa={class:"tab-content"},Ta={class:"toolbar"},Ua=["disabled"],Va=["disabled"],Sa=["disabled"],Aa={class:"backup-list"},Ia={key:0,class:"empty-state"},Ba={key:1,class:"backup-grid"},Da={class:"backup-info"},La={class:"backup-name"},Pa={class:"backup-meta"},Wa={class:"backup-size"},Ra={class:"backup-date"},za={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Ea={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},Na={class:"backup-actions"},Ka=["onClick"],Fa=["onClick"],Oa=["onClick"],Ha=["onClick"],ja={class:"tab-content"},qa={class:"toolbar"},Ga=["disabled"],Ja=["disabled"],Qa={key:1,class:"info-box"},Xa={class:"backup-list"},Ya={key:0,class:"empty-state"},Za={key:1,class:"backup-grid"},eo={class:"backup-info"},to={class:"backup-name"},so={class:"backup-meta"},lo={class:"backup-size"},no={class:"backup-date"},ao={class:"backup-actions"},oo=["onClick"],io=["onClick"],ro={class:"tab-content"},uo={class:"config-section"},co={class:"config-card"},vo={class:"config-header"},po={class:"switch"},mo={key:0,class:"config-fields"},fo={class:"field-row"},go={class:"field-row"},ho={class:"config-card"},bo={class:"config-header"},yo={class:"switch"},ko={key:0,class:"config-fields"},wo={class:"field-row"},_o={class:"time-input"},Co={class:"field-row"},$o={class:"field-row checkbox-row"},Mo={class:"checkbox-label"},xo={class:"config-card"},To={class:"config-header"},Uo={class:"switch"},Vo={class:"config-info"},So={key:0,class:"warning-text"},Ao={key:0,class:"config-fields"},Io={class:"field-row checkbox-row"},Bo={class:"checkbox-label"},Do={class:"field-row checkbox-row"},Lo={class:"checkbox-label"},Po={class:"config-card"},Wo={class:"config-header"},Ro={class:"switch"},zo={key:0,class:"stats-card"},Eo={class:"stats-grid"},No={class:"stat-item"},Ko={class:"stat-value"},Fo={class:"stat-item"},Oo={class:"stat-value"},Ho={class:"stat-item"},jo={class:"stat-value"},qo={class:"stat-item"},Go={class:"stat-value"},Jo={class:"config-actions"},Qo=["disabled"],Xo={key:0,class:"modal-overlay"},Yo={class:"modal-content config-modal"},Zo={class:"form-group"},ei={class:"form-group"},ti={class:"form-group"},si=["placeholder"],li={key:0},ni={key:1},ai={class:"modal-actions"},oi=["disabled"],ii={key:1,class:"modal-overlay"},ri={class:"modal-content"},di={style:{"white-space":"pre-line"}},ui={class:"modal-actions"},ci=["disabled"],vi=["disabled"],pi={key:2,class:"modal-overlay"},mi={class:"modal-content config-modal"},fi={class:"form-group"},gi={class:"form-group"},hi={class:"modal-actions"},bi=["disabled"],yi={key:3,class:"modal-overlay"},ki={class:"modal-content config-modal"},wi={class:"form-group"},_i={class:"modal-actions"},Ci=["disabled"],$i={__name:"BackupManage",setup(r){const t=$("local"),a=$([]),C=$([]),l=$(!1),u=$(!1),I=$(!1),D=$(null),n=ae({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),c=ae({name:"",description:""}),h=ae({oldName:"",newName:""}),b=$({text:"",type:""}),U=ae({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),y=ae({configured:!1,url:"",username:""}),m=ae({url:"",username:"",password:""}),f=ae({debounce:{enabled:!0,delay:5,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),v=$(null),S=localStorage.getItem("token");function T(j){return x(this,arguments,function*(k,s={}){return(yield fetch(k,re(Y({},s),{headers:Y({Authorization:`Bearer ${S}`,"Content-Type":"application/json"},s.headers)}))).json()})}const V=(k,s="success",j=4e3)=>{b.value={text:k,type:s},setTimeout(()=>{b.value={text:"",type:""}},s==="error"?6e3:j)};function H(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[å¤‡ä»½ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(k){console.warn("[å¤‡ä»½ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",k)}}function X(){return x(this,null,function*(){try{const k=yield T("/api/ai/config/verify");k.success&&(k.status==="decrypt_failed"?(V("âš ï¸ AI é…ç½®æ¢å¤å¼‚å¸¸ï¼šAPI Key è§£å¯†å¤±è´¥ï¼Œè¯·å‰å¾€ AI è®¾ç½®é‡æ–°é…ç½®","warning",8e3),setTimeout(()=>{confirm(`AI é…ç½®çš„ API Key è§£å¯†å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤‡ä»½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨ã€‚

æ˜¯å¦ç°åœ¨å‰å¾€ AI è®¾ç½®é¡µé¢é‡æ–°é…ç½®ï¼Ÿ`)&&(window.location.href="/admin/ai-settings")},1e3)):k.status==="ok"&&console.log("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯é€šè¿‡"))}catch(k){console.warn("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯å¤±è´¥:",k)}})}const ee=()=>{c.name="",c.description="",u.value=!0},te=()=>x(null,null,function*(){n.create=!0;const k=yield T("/api/backup/create",{method:"POST",body:JSON.stringify({name:c.name||null,description:c.description||null})});k.success?(V("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),u.value=!1,yield N()):V(k.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),n.create=!1}),le=k=>{h.oldName=k,h.newName=k.replace(".zip",""),I.value=!0},se=()=>x(null,null,function*(){if(!h.newName.trim()){V("è¯·è¾“å…¥æ–°åç§°","error");return}n.rename=!0;const k=yield T(`/api/backup/rename/${h.oldName}`,{method:"PUT",body:JSON.stringify({newName:h.newName})});k.success?(V("é‡å‘½åæˆåŠŸï¼"),I.value=!1,yield N()):V(k.message||"é‡å‘½åå¤±è´¥","error"),n.rename=!1}),N=()=>x(null,null,function*(){n.list=!0;const k=yield T("/api/backup/list");k.success?a.value=k.backups:V("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),n.list=!1}),R=k=>{window.open(`/api/backup/download/${k}?token=${S}`,"_blank")},w=(k,s)=>{const j=typeof s=="object"?s:{name:s},M=j.name;U.show=!0,U.filename=M,U.action=k,U.signed=j.signed,U.processing=!1,k==="delete"?(U.title="åˆ é™¤",U.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`,U.confirmClass="btn-danger"):k==="restore"?(U.title="æ¢å¤",j.signed?U.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`:U.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`,U.confirmClass="btn-restore"):k==="webdav-restore"?(U.title="ä»WebDAVæ¢å¤",U.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${M} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,U.confirmClass="btn-restore"):k==="webdav-delete"&&(U.title="åˆ é™¤WebDAVå¤‡ä»½",U.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${M} å—ï¼Ÿ`,U.confirmClass="btn-danger")},B=()=>x(null,null,function*(){const{action:k,filename:s,signed:j}=U;U.show=!1,U.processing=!1;try{if(k==="delete"){V("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const M=yield T(`/api/backup/delete/${s}`,{method:"DELETE"});M.success?(V("âœ“ åˆ é™¤æˆåŠŸ"),yield N()):V("âœ— "+(M.message||"åˆ é™¤å¤±è´¥"),"error")}else if(k==="restore"){V("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const M=j?{}:{forceRestore:!0},q=yield T(`/api/backup/restore/${s}`,{method:"POST",body:JSON.stringify(M)});if(q.success)V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ue=>setTimeout(ue,2e3)),yield Promise.all([N(),Q(),Z(),P()]),H(),q.checkAIConfig&&(yield X()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(q.requireConfirm&&q.code==="NO_SIGNATURE"){if(confirm(q.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const ue=yield T(`/api/backup/restore/${s}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});ue.success?(V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(Oe=>setTimeout(Oe,2e3)),yield Promise.all([N(),Q(),Z(),P()]),H(),ue.checkAIConfig&&(yield X()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):V("âœ— "+(ue.message||"æ¢å¤å¤±è´¥"),"error")}}else V("âœ— "+(q.message||"æ¢å¤å¤±è´¥"),"error")}else k==="webdav-restore"?yield ge(s):k==="webdav-delete"&&(yield he(s))}catch(M){V("âœ— æ“ä½œå¤±è´¥: "+M.message,"error")}}),L=k=>k?new Date(k).toLocaleString("zh-CN",{hour12:!1}):"--",g=()=>{D.value.click()},p=k=>x(null,null,function*(){const s=k.target.files[0];if(s){if(!s.name.endsWith(".zip")){V("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),k.target.value="";return}if(s.size>500*1024*1024){V("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),k.target.value="";return}n.upload=!0;try{const j=new FormData;j.append("backup",s);const q=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${S}`},body:j})).json();q.success?(V("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield N()):V(q.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(j){console.error("ä¸Šä¼ å¤±è´¥:",j),V("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{n.upload=!1,k.target.value=""}}}),Q=()=>x(null,null,function*(){const k=yield T("/api/backup/webdav/config");k.success&&k.config&&(y.configured=k.config.configured,y.url=k.config.url||"",y.username=k.config.username||"")}),ve=()=>x(null,null,function*(){yield Q(),m.url=y.url,m.username=y.username,m.password="",l.value=!0}),pe=()=>x(null,null,function*(){if(!m.url||!m.username){V("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!y.configured&&!m.password){V("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}n.webdavConfig=!0;const k=yield T("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(m)});k.success?(l.value=!1,yield Q(),y.configured?(yield Z(),yield P(),f.webdav.enabled?V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"):(f.webdav.enabled=!0,(yield T("/api/backup/auto/config",{method:"POST",body:JSON.stringify(f)})).success?V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œå·²è‡ªåŠ¨å¼€å¯WebDAVè‡ªåŠ¨åŒæ­¥ï¼"):V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œä½†è‡ªåŠ¨åŒæ­¥å¼€å¯å¤±è´¥","error"))):V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼")):V(k.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),n.webdavConfig=!1}),me=()=>x(null,null,function*(){n.webdavBackup=!0;const k=yield T("/api/backup/webdav/backup",{method:"POST"});k.success?(V("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield Z()):(V(k.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),k.needReconfigure&&(y.configured=!1,y.url="",y.username="")),n.webdavBackup=!1}),fe=k=>{k.target.checked&&!y.configured&&(f.webdav.enabled=!1,V('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),t.value="webdav")},Z=()=>x(null,null,function*(){n.webdavList=!0;const k=yield T("/api/backup/webdav/list");k.success?(C.value=k.backups||[],k.configured===!1&&(y.configured=!1,y.url="",y.username="",k.message&&V(k.message,"error"))):V(k.message||"è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),n.webdavList=!1}),ge=k=>x(null,null,function*(){V("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),n.webdavRestore=!0;try{const s=yield T("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:k})});s.success?(V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(j=>setTimeout(j,2e3)),yield Promise.all([N(),Q(),Z(),P()]),H(),s.checkAIConfig&&(yield X()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):(V("âœ— "+(s.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error"),s.needReconfigure&&(y.configured=!1,y.url="",y.username=""))}catch(s){V("âœ— æ¢å¤å¤±è´¥: "+s.message,"error")}finally{n.webdavRestore=!1}}),he=k=>x(null,null,function*(){V("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),n.webdavDelete=!0;try{const s=yield T(`/api/backup/webdav/delete/${k}`,{method:"DELETE"});s.success?(V("âœ“ åˆ é™¤æˆåŠŸ"),yield Z()):(V("âœ— "+(s.message||"åˆ é™¤å¤±è´¥"),"error"),s.needReconfigure&&(y.configured=!1,y.url="",y.username=""))}catch(s){V("âœ— åˆ é™¤å¤±è´¥: "+s.message,"error")}finally{n.webdavDelete=!1}}),P=()=>x(null,null,function*(){const k=yield T("/api/backup/auto/config");k.success&&k.config?(Object.assign(f,k.config),v.value=k.stats||null):V("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),O=()=>x(null,null,function*(){n.autoBackupConfig=!0;const k=yield T("/api/backup/auto/config",{method:"POST",body:JSON.stringify(f)});k.success?(V("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield P()):V(k.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),n.autoBackupConfig=!1}),Ke=()=>{if(!f.scheduled.enabled)return"æœªå¯ç”¨";const k=String(f.scheduled.hour).padStart(2,"0"),s=String(f.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${k}:${s}`},Fe=()=>{confirm("ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é…ç½®å—ï¼Ÿè¿™å°†é‡ç½®æ‰€æœ‰è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚")&&(f.debounce={enabled:!0,delay:5,keep:5},f.scheduled={enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},f.webdav={enabled:!1,syncDaily:!0,syncIncremental:!0},f.autoClean=!0,V('å·²æ¢å¤é»˜è®¤é…ç½®ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"ä»¥ç”Ÿæ•ˆ'))};return ne(()=>x(null,null,function*(){yield N(),yield Q(),y.configured&&(yield Z()),yield P()})),(k,s)=>{var j;return o(),i("div",$a,[e("div",Ma,[e("button",{class:E(["tab",{active:t.value==="local"}]),onClick:s[0]||(s[0]=M=>t.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:E(["tab",{active:t.value==="webdav"}]),onClick:s[1]||(s[1]=M=>t.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:E(["tab",{active:t.value==="auto"}]),onClick:s[2]||(s[2]=M=>t.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),_(e("div",xa,[e("div",Ta,[e("button",{class:"btn btn-primary",onClick:ee,disabled:n.create},[s[25]||(s[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+d(n.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,Ua),e("button",{class:"btn btn-success",onClick:g,disabled:n.upload},[s[26]||(s[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),z(" "+d(n.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,Va),e("button",{class:"btn btn-secondary",onClick:N,disabled:n.list},[s[27]||(s[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+d(n.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Sa),e("input",{ref_key:"fileInput",ref:D,type:"file",accept:".zip",onChange:p,style:{display:"none"}},null,544)]),b.value.text?(o(),i("div",{key:0,class:E(["message",b.value.type])},d(b.value.text),3)):A("",!0),e("div",Aa,[a.value.length===0&&!n.list?(o(),i("div",Ia,[...s[28]||(s[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(o(),i("div",Ba,[(o(!0),i(K,null,F(a.value,M=>(o(),i("div",{key:M.name,class:"backup-card"},[s[33]||(s[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Da,[e("div",La,d(M.name),1),e("div",Pa,[e("span",Wa,d(M.size),1),e("span",Ra,d(L(M.created)),1),M.signed?(o(),i("span",za,"ğŸ”’")):(o(),i("span",Ea,"âš ï¸"))])]),e("div",Na,[e("button",{class:"btn-icon btn-restore",onClick:q=>w("restore",M),title:"æ¢å¤å¤‡ä»½"},[...s[29]||(s[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Ka),e("button",{class:"btn-icon btn-rename",onClick:q=>le(M.name),title:"é‡å‘½å"},[...s[30]||(s[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Fa),e("button",{class:"btn-icon",onClick:q=>R(M.name),title:"ä¸‹è½½å¤‡ä»½"},[...s[31]||(s[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Oa),e("button",{class:"btn-icon btn-danger",onClick:q=>w("delete",M.name),title:"åˆ é™¤å¤‡ä»½"},[...s[32]||(s[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Ha)])]))),128))]))])],512),[[Ce,t.value==="local"]]),_(e("div",ja,[e("div",qa,[e("button",{class:"btn btn-primary",onClick:ve},[...s[34]||(s[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),z(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:me,disabled:n.webdavBackup||!y.configured},[s[35]||(s[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+d(n.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Ga),e("button",{class:"btn btn-secondary",onClick:Z,disabled:n.webdavList||!y.configured},[s[36]||(s[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+d(n.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Ja)]),b.value.text?(o(),i("div",{key:0,class:E(["message",b.value.type])},d(b.value.text),3)):A("",!0),y.configured?A("",!0):(o(),i("div",Qa,[...s[37]||(s[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",Xa,[C.value.length===0&&!n.webdavList?(o(),i("div",Ya,[...s[38]||(s[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(o(),i("div",Za,[(o(!0),i(K,null,F(C.value,M=>(o(),i("div",{key:M.name,class:"backup-card"},[s[41]||(s[41]=ie('<div class="backup-icon" data-v-19fdb4a7><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-19fdb4a7><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-19fdb4a7></path><polyline points="14 2 14 8 20 8" data-v-19fdb4a7></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-19fdb4a7></path></svg></div>',1)),e("div",eo,[e("div",to,d(M.name),1),e("div",so,[e("span",lo,d(M.size),1),e("span",no,d(L(M.created)),1)])]),e("div",ao,[e("button",{class:"btn-icon btn-restore",onClick:q=>w("webdav-restore",M.name),title:"ä»WebDAVæ¢å¤"},[...s[39]||(s[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,oo),e("button",{class:"btn-icon btn-danger",onClick:q=>w("webdav-delete",M.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...s[40]||(s[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,io)])]))),128))]))])],512),[[Ce,t.value==="webdav"]]),_(e("div",ro,[b.value.text?(o(),i("div",{key:0,class:E(["message",b.value.type])},d(b.value.text),3)):A("",!0),e("div",uo,[s[76]||(s[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),s[77]||(s[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",co,[e("div",vo,[s[43]||(s[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",po,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=M=>f.debounce.enabled=M)},null,512),[[G,f.debounce.enabled]]),s[42]||(s[42]=e("span",{class:"slider"},null,-1))])]),s[48]||(s[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),f.debounce.enabled?(o(),i("div",mo,[e("div",fo,[s[44]||(s[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),_(e("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=M=>f.debounce.delay=M),min:"5",max:"1440",class:"form-input"},null,512),[[W,f.debounce.delay,void 0,{number:!0}]]),s[45]||(s[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",go,[s[46]||(s[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),_(e("input",{type:"number","onUpdate:modelValue":s[5]||(s[5]=M=>f.debounce.keep=M),min:"1",max:"30",class:"form-input"},null,512),[[W,f.debounce.keep,void 0,{number:!0}]]),s[47]||(s[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):A("",!0)]),e("div",ho,[e("div",bo,[s[50]||(s[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",yo,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=M=>f.scheduled.enabled=M)},null,512),[[G,f.scheduled.enabled]]),s[49]||(s[49]=e("span",{class:"slider"},null,-1))])]),s[58]||(s[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),f.scheduled.enabled?(o(),i("div",ko,[e("div",wo,[s[52]||(s[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",_o,[_(e("input",{type:"number","onUpdate:modelValue":s[7]||(s[7]=M=>f.scheduled.hour=M),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[W,f.scheduled.hour,void 0,{number:!0}]]),s[51]||(s[51]=e("span",null,":",-1)),_(e("input",{type:"number","onUpdate:modelValue":s[8]||(s[8]=M=>f.scheduled.minute=M),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[W,f.scheduled.minute,void 0,{number:!0}]])]),s[53]||(s[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",Co,[s[54]||(s[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),_(e("input",{type:"number","onUpdate:modelValue":s[9]||(s[9]=M=>f.scheduled.keep=M),min:"1",max:"30",class:"form-input"},null,512),[[W,f.scheduled.keep,void 0,{number:!0}]]),s[55]||(s[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",$o,[e("label",Mo,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[10]||(s[10]=M=>f.scheduled.onlyIfModified=M)},null,512),[[G,f.scheduled.onlyIfModified]]),s[56]||(s[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),s[57]||(s[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):A("",!0)]),e("div",xo,[e("div",To,[s[60]||(s[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",Uo,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=M=>f.webdav.enabled=M),onChange:fe},null,544),[[G,f.webdav.enabled]]),s[59]||(s[59]=e("span",{class:"slider"},null,-1))])]),e("p",Vo,[s[61]||(s[61]=z(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),y.configured?A("",!0):(o(),i("span",So,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),f.webdav.enabled?(o(),i("div",Ao,[e("div",Io,[e("label",Bo,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=M=>f.webdav.syncDaily=M)},null,512),[[G,f.webdav.syncDaily]]),s[62]||(s[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),s[63]||(s[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Do,[e("label",Lo,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=M=>f.webdav.syncIncremental=M)},null,512),[[G,f.webdav.syncIncremental]]),s[64]||(s[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),s[65]||(s[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):A("",!0)]),e("div",Po,[e("div",Wo,[s[67]||(s[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Ro,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=M=>f.autoClean=M)},null,512),[[G,f.autoClean]]),s[66]||(s[66]=e("span",{class:"slider"},null,-1))])]),s[68]||(s[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),v.value?(o(),i("div",zo,[s[73]||(s[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Eo,[e("div",No,[s[69]||(s[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Ko,d(((j=v.value.incremental)==null?void 0:j.count)||0)+" ä¸ª",1)]),e("div",Fo,[s[70]||(s[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",Oo,d(L(v.value.lastDebounce)||"æ— "),1)]),e("div",Ho,[s[71]||(s[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",jo,d(L(v.value.lastScheduled)||"æ— "),1)]),e("div",qo,[s[72]||(s[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",Go,d(Ke()),1)])])])):A("",!0),e("div",Jo,[e("button",{class:"btn btn-secondary",onClick:Fe},[...s[74]||(s[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),z(" æ¢å¤é»˜è®¤ ",-1)])]),e("button",{class:"btn btn-primary",onClick:O,disabled:n.autoBackupConfig},[s[75]||(s[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),z(" "+d(n.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Qo)])])],512),[[Ce,t.value==="auto"]]),l.value?(o(),i("div",Xo,[e("div",Yo,[s[82]||(s[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",Zo,[s[78]||(s[78]=e("label",null,[z("WebDAV URL "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":s[15]||(s[15]=M=>m.url=M),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[W,m.url]]),s[79]||(s[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",ei,[s[80]||(s[80]=e("label",null,[z("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":s[16]||(s[16]=M=>m.username=M),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[W,m.username]])]),e("div",ti,[s[81]||(s[81]=e("label",null,[z("å¯†ç  "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"password","onUpdate:modelValue":s[17]||(s[17]=M=>m.password=M),placeholder:y.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,si),[[W,m.password]]),y.configured?(o(),i("small",ni,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(o(),i("small",li,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",ai,[e("button",{class:"btn btn-secondary",onClick:s[18]||(s[18]=M=>l.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:pe,disabled:n.webdavConfig},d(n.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,oi)])])])):A("",!0),U.show?(o(),i("div",ii,[e("div",ri,[e("h3",null,"ç¡®è®¤"+d(U.title),1),e("p",di,d(U.message),1),e("div",ui,[e("button",{class:"btn btn-secondary",onClick:s[19]||(s[19]=M=>U.show=!1),disabled:U.processing},"å–æ¶ˆ",8,ci),e("button",{class:E(["btn",U.confirmClass]),onClick:B,disabled:U.processing},d(U.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,vi)])])])):A("",!0),u.value?(o(),i("div",pi,[e("div",mi,[s[86]||(s[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",fi,[s[83]||(s[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),_(e("input",{type:"text","onUpdate:modelValue":s[20]||(s[20]=M=>c.name=M),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[W,c.name]]),s[84]||(s[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",gi,[s[85]||(s[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),_(e("textarea",{"onUpdate:modelValue":s[21]||(s[21]=M=>c.description=M),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[W,c.description]])]),e("div",hi,[e("button",{class:"btn btn-secondary",onClick:s[22]||(s[22]=M=>u.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:te,disabled:n.create},d(n.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,bi)])])])):A("",!0),I.value?(o(),i("div",yi,[e("div",ki,[s[88]||(s[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",wi,[s[87]||(s[87]=e("label",null,[z("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":s[23]||(s[23]=M=>h.newName=M),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[W,h.newName]]),e("small",null,"åŸåç§°ï¼š"+d(h.oldName),1)]),e("div",_i,[e("button",{class:"btn btn-secondary",onClick:s[24]||(s[24]=M=>I.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:n.rename||!h.newName.trim()},d(n.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,Ci)])])])):A("",!0)])}}},Mi=J($i,[["__scopeId","data-v-19fdb4a7"]]),xi={name:"TaskProgress",props:{task:{type:Object,required:!0,default:()=>({running:!1,current:0,total:0,successCount:0,failCount:0,currentCard:"",startTime:0,concurrency:0,isRateLimited:!1})}},computed:{percent(){return this.task.total?Math.round(this.task.current/this.task.total*100):0},eta(){if(!this.task.startTime||this.task.current<2)return"";const t=(Date.now()-this.task.startTime)/this.task.current,a=(this.task.total-this.task.current)*t;return a<=0?"":a<6e4?`${Math.round(a/1e3)}ç§’`:`${Math.round(a/6e4)}åˆ†é’Ÿ`}}},Ti={class:"task-progress-comp"},Ui={class:"progress-header"},Vi={class:"status-text"},Si={key:0,class:"spinner"},Ai={key:1},Ii={class:"progress-count"},Bi={class:"progress-bar"},Di={class:"progress-meta"},Li=["title"],Pi={key:1,class:"eta"},Wi={class:"task-stats"},Ri={class:"stat success"},zi={class:"stat fail"},Ei={key:0,class:"concurrency"},Ni={key:0,class:"rate-limit"};function Ki(r,t,a,C,l,u){return o(),i("div",Ti,[e("div",Ui,[e("span",Vi,[a.task.running?(o(),i("span",Si,"â³")):(o(),i("span",Ai,"âœ…")),z(" "+d(a.task.running?"æ­£åœ¨å¤„ç†...":"ä»»åŠ¡å·²å®Œæˆ"),1)]),e("span",Ii,d(a.task.current)+" / "+d(a.task.total),1)]),e("div",Bi,[e("div",{class:"progress-fill",style:ke({width:u.percent+"%"})},null,4)]),e("div",Di,[a.task.currentCard?(o(),i("span",{key:0,class:"current-card",title:a.task.currentCard}," å½“å‰: "+d(a.task.currentCard),9,Li)):A("",!0),a.task.running&&u.eta?(o(),i("span",Pi,"é¢„è®¡å‰©ä½™: "+d(u.eta),1)):A("",!0)]),e("div",Wi,[e("div",Ri,"âœ“ æˆåŠŸ "+d(a.task.successCount||0),1),e("div",zi,"âœ— å¤±è´¥ "+d(a.task.failCount||0),1),a.task.running&&a.task.concurrency?(o(),i("div",Ei,[z(" å¹¶å‘: "+d(a.task.concurrency)+" ",1),a.task.isRateLimited?(o(),i("span",Ni,"é™æµä¸­")):A("",!0)])):A("",!0)])])}const Ee=J(xi,[["render",Ki],["__scopeId","data-v-538823c5"]]),Fi={name:"ErrorLogList",props:{errors:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},emptyText:{type:String,default:"å¤„ç†å®Œæˆï¼Œæ— å¤±è´¥é¡¹"}},emits:["retry-all","retry-single"],methods:{formatTime(r){if(!r)return"";const t=new Date(r);return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`}}},Oi={class:"error-header"},Hi={class:"header-left"},ji={class:"title"},qi={key:0,class:"hint"},Gi=["disabled"],Ji={class:"error-body"},Qi={class:"error-info"},Xi={class:"error-row"},Yi=["title"],Zi={class:"error-time"},er=["title"],tr=["onClick","disabled"],sr={key:1,class:"error-empty"};function lr(r,t,a,C,l,u){return o(),i("div",{class:E(["error-log-comp",{"has-errors":a.errors&&a.errors.length>0}])},[e("div",Oi,[e("div",Hi,[e("span",ji,"å¤±è´¥åˆ—è¡¨ ("+d(a.errors?a.errors.length:0)+")",1),a.errors&&a.errors.length>0?(o(),i("span",qi,"å¯ç‚¹å‡»å³ä¾§æŒ‰é’®å•ç‹¬é‡è¯•")):A("",!0)]),a.errors&&a.errors.length>0?(o(),i("button",{key:0,class:"btn-retry-all",onClick:t[0]||(t[0]=I=>r.$emit("retry-all")),disabled:a.disabled}," ğŸ”„ é‡è¯•å…¨éƒ¨å¤±è´¥ ",8,Gi)):A("",!0)]),e("div",Ji,[a.errors&&a.errors.length>0?(o(!0),i(K,{key:0},F(a.errors,(I,D)=>(o(),i("div",{key:D,class:"error-item"},[e("div",Qi,[e("div",Xi,[e("span",{class:"error-title",title:I.cardTitle},d(I.cardTitle||"æœªçŸ¥å¡ç‰‡"),9,Yi),e("span",Zi,d(u.formatTime(I.time)),1)]),e("div",{class:"error-msg",title:I.error},d(I.error||"æœªçŸ¥é”™è¯¯åŸå› "),9,er)]),e("button",{class:"btn-retry-single",onClick:n=>r.$emit("retry-single",I),disabled:a.disabled,title:"é‡è¯•æ­¤å¡ç‰‡"}," é‡è¯• ",8,tr)]))),128)):(o(),i("div",sr,[t[1]||(t[1]=e("div",{class:"empty-icon"},"âœ¨",-1)),e("p",null,d(a.emptyText),1)]))])],2)}const Ne=J(Fi,[["render",lr],["__scopeId","data-v-54aa227d"]]),nr={name:"AIBatchWizard",components:{TaskProgress:Ee,ErrorLogList:Ne},props:{visible:Boolean,activeTask:{type:Object,default:()=>({running:!1})}},emits:["close","start"],data(){return{step:0,stepNames:["é€‰æ‹©èŒƒå›´","ç”Ÿæˆç­–ç•¥","æ•ˆæœé¢„è§ˆ","æ‰§è¡Œä»»åŠ¡"],fieldLabels:{name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},menus:[],subMenus:[],tags:[],filters:{status:["empty_name","empty_desc"],menuId:"",subMenuId:""},filteredCards:[],filtering:!1,strategy:{types:["name","description"],mode:"fill",style:"default",customPrompt:""},previews:[],previewing:!1,taskDone:!1,starting:!1,stopping:!1,lastTaskState:null}},computed:{canNext(){return this.step===0?this.filteredCards.length>0:this.step===1?this.strategy.types.length>0:!0},taskRunning(){var r;return((r=this.activeTask)==null?void 0:r.running)||!1},displayTask(){return this.taskRunning?this.activeTask:this.lastTaskState||this.activeTask||{}}},watch:{visible(r){r&&this.init()},"activeTask.running"(r,t){t===!0&&r===!1&&this.step===3&&(this.taskDone=!0)},activeTask:{handler(r){r&&(r.running||r.errors&&r.errors.length>0||r.total>0)&&(this.lastTaskState=JSON.parse(JSON.stringify(r)))},deep:!0,immediate:!0}},methods:{init(){return x(this,null,function*(){this.step=0,this.previews=[],this.taskDone=!1,this.lastTaskState=null;try{const[r,t]=yield Promise.all([Ve(),Se()]);this.menus=r.data||[],this.tags=t.data||[]}catch(r){}this.applyFilter()})},onMenuChange(){return x(this,null,function*(){this.filters.subMenuId="";const r=this.menus.find(t=>t.id===this.filters.menuId);this.subMenus=(r==null?void 0:r.subMenus)||[],this.applyFilter()})},applyFilter(){return x(this,null,function*(){this.filtering=!0;try{const r={status:this.filters.status};this.filters.menuId&&(r.menuIds=[this.filters.menuId]),this.filters.subMenuId&&(r.subMenuIds=[this.filters.subMenuId]);const{data:t}=yield Ct(r);this.filteredCards=t.cards||[]}catch(r){this.filteredCards=[]}this.filtering=!1})},nextStep(){this.step<3&&this.step++},runPreview(){return x(this,null,function*(){var r,t;this.previewing=!0,this.previews=[];try{const a=this.filteredCards.slice(0,3).map(l=>l.id),{data:C}=yield _t({cardIds:a,types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}});this.previews=C.previews||[]}catch(a){alert("é¢„è§ˆå¤±è´¥: "+(((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||a.message))}this.previewing=!1})},startTask(){return x(this,null,function*(){yield this.doStartTask(this.filteredCards.map(r=>r.id))})},retryCard(r){return x(this,null,function*(){if(!r.cardId){alert("æ— æ³•é‡è¯•ï¼šè¯¥é”™è¯¯æ²¡æœ‰å…³è”çš„å¡ç‰‡ ID");return}yield this.doStartTask([r.cardId])})},retryAllFailed(){return x(this,null,function*(){const r=this.displayTask.errors||[];if(r.length===0)return;const t=r.map(a=>a.cardId).filter(a=>!!a&&a!==0);if(t.length===0){alert("æ²¡æœ‰å¯é‡è¯•çš„å¡ç‰‡ï¼ˆéƒ¨åˆ†ç³»ç»Ÿé”™è¯¯æ— æ³•ç›´æ¥é‡è¯•ï¼‰");return}yield this.doStartTask(t)})},doStartTask(r){return x(this,null,function*(){var t,a;this.starting=!0,this.taskDone=!1;try{const C={cardIds:r,types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}};this.$emit("start",{total:C.cardIds.length,types:C.types,mode:C.strategy.mode,current:0,currentCard:"å¯åŠ¨ä¸­...",errors:[],successCount:0,failCount:0});const{data:l}=yield Te(C);(!l.success||l.total===0)&&(alert(l.message||"æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡"),r.length===this.filteredCards.length&&this.$emit("close"))}catch(C){alert("å¯åŠ¨å¤±è´¥: "+(((a=(t=C.response)==null?void 0:t.data)==null?void 0:a.message)||C.message))}this.starting=!1})},stopTask(){return x(this,null,function*(){this.stopping=!0;try{yield ze()}catch(r){}setTimeout(()=>{this.stopping=!1},1e3)})},extractDomain(r){try{return new URL(r).hostname.replace("www.","")}catch(t){return r}}}},ar={class:"wizard-modal"},or={class:"wizard-header"},ir={class:"steps"},rr={class:"step-num"},dr={class:"step-name"},ur={class:"wizard-body"},cr={key:0,class:"step-content"},vr={class:"filter-section"},pr={class:"checkbox-group"},mr={class:"filter-section"},fr=["value"],gr=["value"],hr={class:"filter-result"},br={class:"result-count"},yr=["disabled"],kr={key:0,class:"card-preview-list"},wr={class:"card-title"},_r={class:"card-url"},Cr={key:0,class:"more-hint"},$r={key:1,class:"step-content"},Mr={class:"filter-section"},xr={class:"checkbox-group"},Tr={class:"filter-section"},Ur={class:"radio-group"},Vr={class:"filter-section"},Sr={class:"filter-section"},Ar={key:2,class:"step-content"},Ir={class:"preview-actions"},Br=["disabled"],Dr={key:0,class:"preview-list"},Lr={class:"preview-title"},Pr={class:"field-label"},Wr={class:"diff-view"},Rr={class:"diff-old"},zr={key:1,class:"preview-hint"},Er={key:3,class:"step-content"},Nr={key:0,class:"execute-confirm"},Kr=["disabled"],Fr={key:1,class:"task-execution-view"},Or={key:1,class:"task-actions"},Hr=["disabled"],jr={class:"wizard-footer"},qr=["disabled"],Gr={class:"footer-right"},Jr=["disabled"];function Qr(r,t,a,C,l,u){const I=ce("TaskProgress"),D=ce("ErrorLogList");return a.visible?(o(),i("div",{key:0,class:"wizard-overlay",onClick:t[26]||(t[26]=we(n=>r.$emit("close"),["self"]))},[e("div",ar,[e("div",or,[t[27]||(t[27]=e("h3",null,"ğŸ¤– AI æ‰¹é‡ç”Ÿæˆå‘å¯¼",-1)),e("button",{class:"close-btn",onClick:t[0]||(t[0]=n=>r.$emit("close"))},"âœ•")]),e("div",ir,[(o(!0),i(K,null,F(l.stepNames,(n,c)=>(o(),i("div",{key:c,class:E(["step",{active:l.step===c,done:l.step>c}])},[e("span",rr,d(l.step>c?"âœ“":c+1),1),e("span",dr,d(n),1)],2))),128))]),e("div",ur,[l.step===0?(o(),i("div",cr,[e("div",vr,[t[31]||(t[31]=e("h4",null,"çŠ¶æ€ç­›é€‰",-1)),e("div",pr,[e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=n=>l.filters.status=n),value:"empty_name",onChange:t[2]||(t[2]=(...n)=>u.applyFilter&&u.applyFilter(...n))},null,544),[[G,l.filters.status]]),t[28]||(t[28]=z(" ç¼ºåç§°",-1))]),e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=n=>l.filters.status=n),value:"empty_desc",onChange:t[4]||(t[4]=(...n)=>u.applyFilter&&u.applyFilter(...n))},null,544),[[G,l.filters.status]]),t[29]||(t[29]=z(" ç¼ºæè¿°",-1))]),e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=n=>l.filters.status=n),value:"empty_tags",onChange:t[6]||(t[6]=(...n)=>u.applyFilter&&u.applyFilter(...n))},null,544),[[G,l.filters.status]]),t[30]||(t[30]=z(" ç¼ºæ ‡ç­¾",-1))])])]),e("div",mr,[t[34]||(t[34]=e("h4",null,"èœå•ç­›é€‰",-1)),_(e("select",{"onUpdate:modelValue":t[7]||(t[7]=n=>l.filters.menuId=n),onChange:t[8]||(t[8]=(...n)=>u.onMenuChange&&u.onMenuChange(...n)),class:"input"},[t[32]||(t[32]=e("option",{value:""},"å…¨éƒ¨èœå•",-1)),(o(!0),i(K,null,F(l.menus,n=>(o(),i("option",{key:n.id,value:n.id},d(n.name),9,fr))),128))],544),[[oe,l.filters.menuId]]),l.subMenus.length?_((o(),i("select",{key:0,"onUpdate:modelValue":t[9]||(t[9]=n=>l.filters.subMenuId=n),onChange:t[10]||(t[10]=(...n)=>u.applyFilter&&u.applyFilter(...n)),class:"input",style:{"margin-top":"8px"}},[t[33]||(t[33]=e("option",{value:""},"å…¨éƒ¨å­èœå•",-1)),(o(!0),i(K,null,F(l.subMenus,n=>(o(),i("option",{key:n.id,value:n.id},d(n.name),9,gr))),128))],544)),[[oe,l.filters.subMenuId]]):A("",!0)]),e("div",hr,[e("span",br,[t[35]||(t[35]=z("å·²é€‰ä¸­ ",-1)),e("strong",null,d(l.filteredCards.length),1),t[36]||(t[36]=z(" ä¸ªå¡ç‰‡",-1))]),e("button",{class:"btn sm",onClick:t[11]||(t[11]=(...n)=>u.applyFilter&&u.applyFilter(...n)),disabled:l.filtering},d(l.filtering?"ç­›é€‰ä¸­...":"ğŸ”„ åˆ·æ–°"),9,yr)]),l.filteredCards.length?(o(),i("div",kr,[(o(!0),i(K,null,F(l.filteredCards.slice(0,10),n=>(o(),i("div",{key:n.id,class:"card-preview-item"},[e("span",wr,d(n.title||u.extractDomain(n.url)),1),e("span",_r,d(n.url),1)]))),128)),l.filteredCards.length>10?(o(),i("div",Cr,"è¿˜æœ‰ "+d(l.filteredCards.length-10)+" ä¸ª...",1)):A("",!0)])):A("",!0)])):A("",!0),l.step===1?(o(),i("div",$r,[e("div",Mr,[t[40]||(t[40]=e("h4",null,"ç”Ÿæˆå­—æ®µ",-1)),e("div",xr,[e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=n=>l.strategy.types=n),value:"name"},null,512),[[G,l.strategy.types]]),t[37]||(t[37]=z(" åç§°",-1))]),e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=n=>l.strategy.types=n),value:"description"},null,512),[[G,l.strategy.types]]),t[38]||(t[38]=z(" æè¿°",-1))]),e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=n=>l.strategy.types=n),value:"tags"},null,512),[[G,l.strategy.types]]),t[39]||(t[39]=z(" æ ‡ç­¾",-1))])])]),e("div",Tr,[t[43]||(t[43]=e("h4",null,"ç”Ÿæˆæ¨¡å¼",-1)),e("div",Ur,[e("label",null,[_(e("input",{type:"radio","onUpdate:modelValue":t[15]||(t[15]=n=>l.strategy.mode=n),value:"fill"},null,512),[[De,l.strategy.mode]]),t[41]||(t[41]=z(" è¡¥å…¨æ¨¡å¼ï¼ˆä»…å¡«å……ç©ºå­—æ®µï¼‰",-1))]),e("label",null,[_(e("input",{type:"radio","onUpdate:modelValue":t[16]||(t[16]=n=>l.strategy.mode=n),value:"overwrite"},null,512),[[De,l.strategy.mode]]),t[42]||(t[42]=z(" è¦†ç›–æ¨¡å¼ï¼ˆé‡æ–°ç”Ÿæˆæ‰€æœ‰ï¼‰",-1))])])]),e("div",Vr,[t[45]||(t[45]=e("h4",null,"ç”Ÿæˆé£æ ¼",-1)),_(e("select",{"onUpdate:modelValue":t[17]||(t[17]=n=>l.strategy.style=n),class:"input"},[...t[44]||(t[44]=[ie('<option value="default" data-v-31988f37>é»˜è®¤</option><option value="concise" data-v-31988f37>ç®€æ´æœ‰åŠ›</option><option value="professional" data-v-31988f37>ä¸“ä¸šæ­£å¼</option><option value="friendly" data-v-31988f37>å‹å¥½è½»æ¾</option><option value="seo" data-v-31988f37>SEO ä¼˜åŒ–</option>',5)])],512),[[oe,l.strategy.style]])]),e("div",Sr,[t[46]||(t[46]=e("h4",null,"è‡ªå®šä¹‰æç¤ºï¼ˆå¯é€‰ï¼‰",-1)),_(e("textarea",{"onUpdate:modelValue":t[18]||(t[18]=n=>l.strategy.customPrompt=n),class:"input",rows:"2",placeholder:"ä¾‹å¦‚ï¼šè¯·ä½¿ç”¨ä¸­æ–‡ï¼Œæè¿°æ§åˆ¶åœ¨30å­—ä»¥å†…"},null,512),[[W,l.strategy.customPrompt]])])])):A("",!0),l.step===2?(o(),i("div",Ar,[e("div",Ir,[e("button",{class:"btn primary",onClick:t[19]||(t[19]=(...n)=>u.runPreview&&u.runPreview(...n)),disabled:l.previewing},d(l.previewing?"â³ ç”Ÿæˆé¢„è§ˆä¸­...":"ğŸ”® è¯•è¿è¡Œï¼ˆéšæœº3ä¸ªï¼‰"),9,Br)]),l.previews.length?(o(),i("div",Dr,[(o(!0),i(K,null,F(l.previews,n=>(o(),i("div",{key:n.cardId,class:"preview-card"},[e("div",Lr,d(n.title||u.extractDomain(n.url)),1),(o(!0),i(K,null,F(n.fields,(c,h)=>(o(),i("div",{key:h,class:"preview-field"},[e("span",Pr,d(l.fieldLabels[h]),1),e("div",Wr,[e("div",Rr,d(c.original||"(ç©º)"),1),t[47]||(t[47]=e("div",{class:"diff-arrow"},"â†’",-1)),e("div",{class:E(["diff-new",{error:c.error}])},d(c.error||c.generated||"(ç©º)"),3)])]))),128))]))),128))])):l.previewing?A("",!0):(o(),i("div",zr,' ç‚¹å‡»"è¯•è¿è¡Œ"é¢„è§ˆ AI ç”Ÿæˆæ•ˆæœï¼Œä¸æ»¡æ„å¯è¿”å›è°ƒæ•´ç­–ç•¥ '))])):A("",!0),l.step===3?(o(),i("div",Er,[!u.taskRunning&&!l.taskDone?(o(),i("div",Nr,[e("p",null,[t[48]||(t[48]=z("å³å°†å¤„ç† ",-1)),e("strong",null,d(l.filteredCards.length),1),t[49]||(t[49]=z(" ä¸ªå¡ç‰‡",-1))]),e("p",null,"ç”Ÿæˆå­—æ®µï¼š"+d(l.strategy.types.map(n=>l.fieldLabels[n]).join("ã€")),1),e("p",null,"ç”Ÿæˆæ¨¡å¼ï¼š"+d(l.strategy.mode==="fill"?"è¡¥å…¨æ¨¡å¼":"è¦†ç›–æ¨¡å¼"),1),e("button",{class:"btn primary lg",onClick:t[20]||(t[20]=(...n)=>u.startTask&&u.startTask(...n)),disabled:l.starting},d(l.starting?"å¯åŠ¨ä¸­...":"ğŸš€ å¼€å§‹æ‰§è¡Œ"),9,Kr)])):A("",!0),u.taskRunning||l.taskDone?(o(),i("div",Fr,[_e(I,{task:u.displayTask},null,8,["task"]),u.displayTask.failCount>0||!u.taskRunning?(o(),Ue(D,{key:0,errors:u.displayTask.errors,disabled:l.starting||u.taskRunning,onRetryAll:u.retryAllFailed,onRetrySingle:u.retryCard,"empty-text":"å¤„ç†å®Œæˆï¼Œæ— å¤±è´¥é¡¹"},null,8,["errors","disabled","onRetryAll","onRetrySingle"])):A("",!0),u.taskRunning?(o(),i("div",Or,[e("button",{class:"btn danger",onClick:t[21]||(t[21]=(...n)=>u.stopTask&&u.stopTask(...n)),disabled:l.stopping},d(l.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,Hr)])):A("",!0)])):A("",!0)])):A("",!0)]),e("div",jr,[e("button",{class:"btn",onClick:t[22]||(t[22]=n=>r.$emit("close")),disabled:u.taskRunning},"å–æ¶ˆ",8,qr),e("div",Gr,[l.step>0&&!u.taskRunning?(o(),i("button",{key:0,class:"btn",onClick:t[23]||(t[23]=n=>l.step--)},"ä¸Šä¸€æ­¥")):A("",!0),l.step<3?(o(),i("button",{key:1,class:"btn primary",onClick:t[24]||(t[24]=(...n)=>u.nextStep&&u.nextStep(...n)),disabled:!u.canNext},d(l.step===2?"ä¸‹ä¸€æ­¥ï¼šæ‰§è¡Œ":"ä¸‹ä¸€æ­¥"),9,Jr)):A("",!0),l.step===3&&l.taskDone?(o(),i("button",{key:2,class:"btn primary",onClick:t[25]||(t[25]=n=>r.$emit("close"))},"å®Œæˆ")):A("",!0)])])])])):A("",!0)}const Xr=J(nr,[["render",Qr],["__scopeId","data-v-31988f37"]]),Me={deepseek:{name:"DeepSeek",icon:"ğŸ³",recommended:!0,docsUrl:"https://platform.deepseek.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"deepseek-chat",models:["deepseek-chat","deepseek-reasoner"]},openai:{name:"OpenAI",icon:"ğŸ¤–",docsUrl:"https://platform.openai.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gpt-4o-mini",models:["gpt-4o-mini","gpt-4o","gpt-3.5-turbo"]},gemini:{name:"Google Gemini",icon:"â™Š",docsUrl:"https://aistudio.google.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gemini-1.5-flash",models:["gemini-1.5-flash","gemini-1.5-pro"]},anthropic:{name:"Anthropic",icon:"ğŸ¨",docsUrl:"https://console.anthropic.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"claude-3-haiku-20240307",models:["claude-3-5-sonnet-20240620","claude-3-haiku-20240307"]},zhipu:{name:"æ™ºè°± AI",icon:"ğŸ§ ",docsUrl:"https://open.bigmodel.cn/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"glm-4-flash",models:["glm-4-flash","glm-4"]},ollama:{name:"Ollama",icon:"ğŸ¦™",local:!0,docsUrl:"https://ollama.com/",needsApiKey:!1,needsBaseUrl:!0,defaultBaseUrl:"http://localhost:11434",defaultModel:"llama3",models:["llama3","qwen2","mistral"]},custom:{name:"è‡ªå®šä¹‰",icon:"ğŸ› ï¸",needsApiKey:!0,needsBaseUrl:!0,defaultModel:"",models:[]}},Yr={name:"AISettings",components:{AIBatchWizard:Xr,TaskProgress:Ee,ErrorLogList:Ne},data(){return{providers:Me,config:{provider:"deepseek",apiKey:"",baseUrl:"",model:"deepseek-chat",autoGenerate:!1,hasApiKey:!1},modelSelect:"deepseek-chat",showApiKey:!1,testing:!1,saving:!1,refreshing:!1,starting:!1,stopping:!1,connectionTested:!1,connectionOk:!1,stats:null,task:{running:!1,type:"",mode:"",current:0,total:0,currentCard:"",startTime:0,errors:[],successCount:0,failCount:0,concurrency:0,isRateLimited:!1,types:[]},eventSource:null,toast:{show:!1,msg:"",type:"info"},showWizard:!1}},computed:{currentProvider(){return Me[this.config.provider]||Me.deepseek},canTest(){return!(this.currentProvider.needsApiKey&&!this.config.apiKey&&!this.config.hasApiKey||this.currentProvider.needsBaseUrl&&!this.config.baseUrl)},connectionStatus(){return!this.config.hasApiKey&&!this.config.apiKey?"none":this.connectionTested?this.connectionOk?"ok":"err":"pending"},statusText(){return{none:"æœªé…ç½®",ok:"å·²è¿æ¥",err:"è¿æ¥å¤±è´¥",pending:"å¾…æµ‹è¯•"}[this.connectionStatus]},totalMissing(){return this.stats?this.stats.emptyName+this.stats.emptyDesc+this.stats.emptyTags:0},taskTitle(){const r={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},t=this.task.types||[this.task.type];return Array.isArray(t)&&t.length>0?`æ­£åœ¨ç”Ÿæˆ${t.map(a=>r[a]||a).join("ã€")}`:"æ­£åœ¨è¿›è¡Œæ‰¹é‡ä»»åŠ¡"}},mounted(){return x(this,null,function*(){yield this.loadConfig(),yield this.refreshStats(),yield this.initRealtimeUpdates(),document.addEventListener("visibilitychange",this.handleVisibilityChange)})},beforeUnmount(){this.closeEventSource(),document.removeEventListener("visibilitychange",this.handleVisibilityChange)},methods:{handleVisibilityChange(){document.visibilityState==="visible"&&(this.refreshStats(),this.eventSource||this.initRealtimeUpdates())},selectProvider(r){var t;this.config.provider=r,this.config.model=this.currentProvider.defaultModel,this.modelSelect=(t=this.currentProvider.models)!=null&&t.includes(this.config.model)?this.config.model:"",this.config.baseUrl=this.currentProvider.defaultBaseUrl||"",this.config.apiKey="",this.config.hasApiKey=!1,this.connectionTested=!1},onModelChange(){this.modelSelect&&(this.config.model=this.modelSelect)},loadConfig(){return x(this,null,function*(){var r;try{const{data:t}=yield Tt();if(t.success){const a=t.config;this.config=Y(Y({},this.config),a),this.modelSelect=(r=this.currentProvider.models)!=null&&r.includes(this.config.model)?this.config.model:"",a.lastTestedOk&&(this.connectionTested=!0,this.connectionOk=!0)}}catch(t){}})},saveConfig(){return x(this,null,function*(){var r,t;this.saving=!0;try{const{data:a}=yield xt({provider:this.config.provider,apiKey:this.config.apiKey||void 0,baseUrl:this.config.baseUrl||this.currentProvider.defaultBaseUrl,model:this.config.model,autoGenerate:this.config.autoGenerate});a.success?(this.showToast("é…ç½®å·²ä¿å­˜","success"),this.config.hasApiKey=!0,this.config.apiKey="",this.testConnection()):this.showToast(a.message,"error")}catch(a){this.showToast(((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||"ä¿å­˜å¤±è´¥","error")}this.saving=!1})},testConnection(){return x(this,null,function*(){this.testing=!0;try{const{data:r}=yield Mt();this.connectionTested=!0,this.connectionOk=r.success,this.showToast(r.success?"è¿æ¥æˆåŠŸ":r.message,r.success?"success":"error")}catch(r){this.connectionTested=!0,this.connectionOk=!1,this.showToast("è¿æ¥å¤±è´¥","error")}this.testing=!1})},refreshStats(){return x(this,null,function*(){this.refreshing=!0;try{const{data:r}=yield $t();r.success&&(this.stats=r.stats)}catch(r){}this.refreshing=!1})},initRealtimeUpdates(){return x(this,null,function*(){this.closeEventSource();const r=localStorage.getItem("token"),t=`/api/ai/batch-task/stream${r?"?token="+encodeURIComponent(r):""}`;this.eventSource=new EventSource(t),this.eventSource.onmessage=a=>{try{const C=JSON.parse(a.data);this.updateTaskState(C)}catch(C){}},this.eventSource.onerror=()=>this.closeEventSource()})},closeEventSource(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)},updateTaskState(r){if(r){if(this.task.running&&!r.running){this.task=re(Y(Y({},this.task),r),{running:!0,current:r.total||this.task.total}),this.refreshStats(),this.showToast(`ä»»åŠ¡ç»“æŸï¼æˆåŠŸ ${r.successCount||0}ï¼Œå¤±è´¥ ${r.failCount||0}`,r.failCount>0?"info":"success"),setTimeout(()=>{this.task.running=!1,this.refreshStats()},2e3);return}if(r.running||this.task.running){const t=this.task.running&&!r.running;this.task=re(Y(Y({},this.task),r),{running:t?!0:!!r.running,startTime:r.startTime||this.task.startTime||Date.now()})}}},startTask(r,t){return x(this,null,function*(){var a,C;if(!(this.starting||this.task.running)){this.starting=!0;try{const l={type:r,mode:t};this.task={running:!0,type:r,mode:t,current:0,total:0,successCount:0,failCount:0,currentCard:"å‡†å¤‡ä¸­...",startTime:Date.now(),errors:[],types:r==="all"?["name","description","tags"]:[r]};const{data:u}=yield Te(l);!u.success||u.total===0?(this.showToast(u.message||"æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡","info"),this.task.running=!1,this.refreshStats()):(this.task.total=u.total,this.initRealtimeUpdates())}catch(l){this.showToast(((C=(a=l.response)==null?void 0:a.data)==null?void 0:C.message)||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1}finally{this.starting=!1}}})},stopTask(){return x(this,null,function*(){this.stopping=!0;try{yield ze(),this.refreshStats()}catch(r){}setTimeout(()=>{this.stopping=!1},1e3)})},retryCard(r){return x(this,null,function*(){r.cardId&&(yield this.doStartBatchTask([r.cardId],this.task.types||["name","description","tags"]))})},retryAllFailed(){return x(this,null,function*(){const r=this.task.errors.map(t=>t.cardId).filter(t=>!!t);r.length!==0&&(yield this.doStartBatchTask(r,this.task.types||["name","description","tags"]))})},doStartBatchTask(r,t){return x(this,null,function*(){var a,C;if(!(this.starting||this.task.running)){this.starting=!0;try{this.task={running:!0,current:0,total:r.length,successCount:0,failCount:0,currentCard:"å‡†å¤‡ä¸­...",startTime:Date.now(),errors:[],types:t},yield Te({cardIds:r,types:t}),this.initRealtimeUpdates()}catch(l){this.showToast(((C=(a=l.response)==null?void 0:a.data)==null?void 0:C.message)||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1}finally{this.starting=!1}}})},showToast(r,t="info"){this.toast={show:!0,msg:r,type:t},setTimeout(()=>{this.toast.show=!1},3e3)},onWizardClose(){this.showWizard=!1,this.refreshStats(),this.task.running||this.initRealtimeUpdates()},onWizardStart(r){this.task=re(Y(Y({},this.task),r),{running:!0,startTime:Date.now()}),this.initRealtimeUpdates()}}},Zr={class:"ai-settings"},ed={class:"page-header"},td={key:0,class:"quick-start"},sd={class:"section"},ld={class:"provider-grid"},nd=["onClick"],ad={class:"provider-icon"},od={class:"provider-info"},id={class:"provider-name"},rd={key:0,class:"provider-tag"},dd={key:1,class:"provider-tag local"},ud={class:"section"},cd={class:"section-header"},vd=["href"],pd={class:"config-form"},md={key:0,class:"form-item"},fd={class:"input-group"},gd=["type","placeholder"],hd={key:1,class:"form-item"},bd=["placeholder"],yd={class:"form-item"},kd={class:"model-select"},wd=["value"],_d=["placeholder"],Cd={class:"form-item switch-item"},$d={class:"switch"},Md={class:"form-actions"},xd=["disabled"],Td=["disabled"],Ud={class:"section"},Vd={class:"section-header"},Sd=["disabled"],Ad={key:0,class:"stats"},Id={class:"stat"},Bd={key:1,class:"task-panel"},Dd={class:"task-panel-title"},Ld={key:1,class:"task-actions"},Pd=["disabled"],Wd={key:2,class:"batch-actions"},Rd={class:"action-bar"},zd=["disabled"],Ed=["disabled"],Nd={key:0,class:"action-hint"};function Kd(r,t,a,C,l,u){const I=ce("TaskProgress"),D=ce("ErrorLogList"),n=ce("AIBatchWizard");return o(),i("div",Zr,[e("div",ed,[t[14]||(t[14]=e("h2",null,"ğŸ¤– AI æ™ºèƒ½ç”Ÿæˆ",-1)),e("div",{class:E(["connection-status",u.connectionStatus])},[t[13]||(t[13]=e("span",{class:"status-dot"},null,-1)),e("span",null,d(u.statusText),1)],2)]),!l.config.hasApiKey&&!l.config.apiKey?(o(),i("div",td,[...t[15]||(t[15]=[ie('<div class="quick-start-icon" data-v-cdc56e79>ğŸš€</div><div class="quick-start-content" data-v-cdc56e79><h4 data-v-cdc56e79>å¿«é€Ÿå¼€å§‹</h4><p data-v-cdc56e79>é…ç½® AI æœåŠ¡åï¼Œå¯è‡ªåŠ¨ä¸ºå¡ç‰‡ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾</p><div class="quick-start-steps" data-v-cdc56e79><span class="step" data-v-cdc56e79>1. é€‰æ‹©æä¾›å•†</span><span class="step" data-v-cdc56e79>2. å¡«å†™ API Key</span><span class="step" data-v-cdc56e79>3. æµ‹è¯•è¿æ¥</span></div></div>',2)])])):A("",!0),e("div",sd,[t[16]||(t[16]=e("div",{class:"section-header"},[e("h3",null,"é€‰æ‹© AI æä¾›å•†"),e("span",{class:"section-hint"},"æ¨èä½¿ç”¨ DeepSeekï¼Œæ€§ä»·æ¯”é«˜")],-1)),e("div",ld,[(o(!0),i(K,null,F(l.providers,(c,h)=>(o(),i("div",{key:h,class:E(["provider-card",{active:l.config.provider===h}]),onClick:b=>u.selectProvider(h)},[e("div",ad,d(c.icon),1),e("div",od,[e("span",id,d(c.name),1),c.recommended?(o(),i("span",rd,"æ¨è")):A("",!0),c.local?(o(),i("span",dd,"æœ¬åœ°")):A("",!0)])],10,nd))),128))])]),e("div",ud,[e("div",cd,[t[17]||(t[17]=e("h3",null,"API é…ç½®",-1)),u.currentProvider.docsUrl?(o(),i("a",{key:0,href:u.currentProvider.docsUrl,target:"_blank",class:"docs-link"}," ğŸ“– è·å– API Key ",8,vd)):A("",!0)]),e("div",pd,[u.currentProvider.needsApiKey?(o(),i("div",md,[e("label",null,[t[18]||(t[18]=e("span",null,"API Key",-1)),e("span",{class:E(["label-status",{ok:l.config.hasApiKey}])},d(l.config.hasApiKey?"âœ“ å·²é…ç½®":"æœªé…ç½®"),3)]),e("div",fd,[_(e("input",{type:l.showApiKey?"text":"password","onUpdate:modelValue":t[0]||(t[0]=c=>l.config.apiKey=c),placeholder:l.config.hasApiKey?"å·²é…ç½®ï¼ˆç•™ç©ºä¿æŒä¸å˜ï¼‰":"è¯·è¾“å…¥ API Key",class:"input"},null,8,gd),[[Re,l.config.apiKey]]),e("button",{type:"button",class:"input-btn",onClick:t[1]||(t[1]=c=>l.showApiKey=!l.showApiKey)},d(l.showApiKey?"ğŸ™ˆ":"ğŸ‘ï¸"),1)])])):A("",!0),u.currentProvider.needsBaseUrl?(o(),i("div",hd,[t[19]||(t[19]=e("label",null,"Base URL",-1)),_(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=c=>l.config.baseUrl=c),placeholder:u.currentProvider.defaultBaseUrl,class:"input"},null,8,bd),[[W,l.config.baseUrl]])])):A("",!0),e("div",yd,[t[21]||(t[21]=e("label",null,"æ¨¡å‹",-1)),e("div",kd,[_(e("select",{"onUpdate:modelValue":t[3]||(t[3]=c=>l.modelSelect=c),class:"input",onChange:t[4]||(t[4]=(...c)=>u.onModelChange&&u.onModelChange(...c))},[t[20]||(t[20]=e("option",{value:""},"è‡ªå®šä¹‰æ¨¡å‹",-1)),(o(!0),i(K,null,F(u.currentProvider.models,c=>(o(),i("option",{key:c,value:c},d(c),9,wd))),128))],544),[[oe,l.modelSelect]]),l.modelSelect===""?_((o(),i("input",{key:0,type:"text","onUpdate:modelValue":t[5]||(t[5]=c=>l.config.model=c),placeholder:u.currentProvider.defaultModel||"è¾“å…¥æ¨¡å‹åç§°",class:"input"},null,8,_d)),[[W,l.config.model]]):A("",!0)])]),e("div",Cd,[t[23]||(t[23]=e("span",null,[e("strong",null,"è‡ªåŠ¨ç”Ÿæˆ"),e("small",null,"æ·»åŠ å¡ç‰‡æ—¶è‡ªåŠ¨ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾")],-1)),e("label",$d,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=c=>l.config.autoGenerate=c)},null,512),[[G,l.config.autoGenerate]]),t[22]||(t[22]=e("span",{class:"slider"},null,-1))])]),e("div",Md,[e("button",{class:"btn",onClick:t[7]||(t[7]=(...c)=>u.testConnection&&u.testConnection(...c)),disabled:l.testing||!u.canTest},d(l.testing?"â³ æµ‹è¯•ä¸­...":"ğŸ”— æµ‹è¯•è¿æ¥"),9,xd),e("button",{class:"btn primary",onClick:t[8]||(t[8]=(...c)=>u.saveConfig&&u.saveConfig(...c)),disabled:l.saving},d(l.saving?"â³ ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜é…ç½®"),9,Td)])])]),e("div",Ud,[e("div",Vd,[t[24]||(t[24]=e("h3",null,"æ‰¹é‡ç”Ÿæˆ",-1)),e("button",{class:"icon-btn",onClick:t[9]||(t[9]=(...c)=>u.refreshStats&&u.refreshStats(...c)),disabled:l.refreshing},d(l.refreshing?"â³":"ğŸ”„"),9,Sd)]),l.stats?(o(),i("div",Ad,[e("div",Id,[e("span",null,d(l.stats.total),1),t[25]||(t[25]=z("æ€»æ•°",-1))]),e("div",{class:E(["stat",{warn:l.stats.emptyName}])},[e("span",null,d(l.stats.emptyName),1),t[26]||(t[26]=z("ç¼ºåç§°",-1))],2),e("div",{class:E(["stat",{warn:l.stats.emptyDesc}])},[e("span",null,d(l.stats.emptyDesc),1),t[27]||(t[27]=z("ç¼ºæè¿°",-1))],2),e("div",{class:E(["stat",{warn:l.stats.emptyTags}])},[e("span",null,d(l.stats.emptyTags),1),t[28]||(t[28]=z("ç¼ºæ ‡ç­¾",-1))],2)])):A("",!0),l.task.running&&!l.showWizard?(o(),i("div",Bd,[e("h4",Dd,d(u.taskTitle),1),_e(I,{task:l.task},null,8,["task"]),l.task.failCount>0||!l.task.running?(o(),Ue(D,{key:0,errors:l.task.errors,disabled:l.starting||l.task.running,onRetryAll:u.retryAllFailed,onRetrySingle:u.retryCard},null,8,["errors","disabled","onRetryAll","onRetrySingle"])):A("",!0),l.task.running?(o(),i("div",Ld,[e("button",{class:"btn danger sm",onClick:t[10]||(t[10]=(...c)=>u.stopTask&&u.stopTask(...c)),disabled:l.stopping},d(l.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,Pd)])):A("",!0)])):(o(),i("div",Wd,[e("div",Rd,[e("button",{class:"btn primary lg main-action",onClick:t[11]||(t[11]=c=>u.startTask("all","empty")),disabled:!l.config.hasApiKey||l.starting||u.totalMissing===0}," âœ¨ æ™ºèƒ½è¡¥å…¨ç¼ºå¤±å†…å®¹ ("+d(u.totalMissing)+") ",9,zd),e("button",{class:"btn lg outline wizard-action",onClick:t[12]||(t[12]=c=>l.showWizard=!0),disabled:!l.config.hasApiKey}," ğŸ¯ é«˜çº§æ‰¹é‡ç”Ÿæˆå‘å¯¼ ",8,Ed)]),u.totalMissing>0?(o(),i("p",Nd," è¡¥å…¨å°†è‡ªåŠ¨åˆ†æ URL å¹¶ç”Ÿæˆç¼ºå¤±çš„åç§°ã€æè¿°å’Œæ ‡ç­¾ã€‚ ")):A("",!0)]))]),_e(n,{visible:l.showWizard,"active-task":l.task,onClose:u.onWizardClose,onStart:u.onWizardStart},null,8,["visible","active-task","onClose","onStart"]),e("div",{class:E(["toast",[l.toast.type,{show:l.toast.show}]])},d(l.toast.msg),3)])}const Fd=J(Yr,[["render",Kd],["__scopeId","data-v-cdc56e79"]]),Od={key:0,class:"login-container"},Hd={class:"login-card"},jd={class:"login-form"},qd={class:"password-input-wrapper"},Gd=["type"],Jd={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Qd={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Xd={class:"login-buttons"},Yd=["disabled"],Zd={key:0,class:"login-error"},eu={key:1,class:"admin-layout"},tu={class:"menu-list"},su={class:"admin-main"},lu={class:"admin-header"},nu={class:"header-title"},au={class:"admin-content"},We=1800*1e3,ou={__name:"Admin",setup(r){const t=$("welcome");let a=null,C=Date.now();function l(){C=Date.now(),localStorage.setItem("lastActivityTime",C.toString()),a&&clearTimeout(a),v.value&&(a=setTimeout(()=>{u()},We))}function u(){v.value&&(alert("ç”±äºé•¿æ—¶é—´æœªæ“ä½œï¼Œå·²è‡ªåŠ¨é€€å‡ºç™»å½•"),N())}function I(){const L=localStorage.getItem("lastActivityTime");return L&&Date.now()-parseInt(L)>=We?(localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),!0):!1}const D=["mousedown","mousemove","keydown","scroll","touchstart","click"];function n(){D.forEach(L=>{document.addEventListener(L,l,{passive:!0})})}function c(){D.forEach(L=>{document.removeEventListener(L,l)})}Qe(()=>{a&&clearTimeout(a),c()});const h={welcome:Wt,menu:Ss,card:gl,duplicate:Zl,tag:bn,promo:Jn,friend:aa,user:Ca,backup:Mi,ai:Fd},b=de(()=>h[t.value]),U=de(()=>t.value==="welcome"?{lastLoginTime:y.value,lastLoginIp:m.value,currentUsername:f.value}:{}),y=$(""),m=$(""),f=$("admin"),v=$(!1),S=$(""),T=$(""),V=$(!1),H=$(""),X=$(!1),ee=$(!1),te=de(()=>{switch(t.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"promo":return"å®£ä¼ ç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";case"ai":return"AI è®¾ç½®";default:return""}});ne(()=>x(null,null,function*(){if(I()){v.value=!1;return}localStorage.getItem("token")?(v.value=!0,yield le(),v.value&&(l(),n())):v.value=!1}));function le(){return x(this,null,function*(){try{const L=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(L.ok){const g=yield L.json();y.value=g.last_login_time||"",m.value=g.last_login_ip||"",f.value=g.username||"admin"}else L.status===401&&(console.warn("TokenéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨é€€å‡ºç™»å½•"),N())}catch(L){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",L)}})}function se(){return x(this,null,function*(){var L,g;if(!S.value||!T.value){H.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}V.value=!0,H.value="";try{const p=yield Ut(S.value,T.value);p.data.token&&(localStorage.setItem("token",p.data.token),v.value=!0,y.value=p.data.lastLoginTime||"",m.value=p.data.lastLoginIp||"",yield le(),l(),n())}catch(p){H.value=((g=(L=p.response)==null?void 0:L.data)==null?void 0:g.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{V.value=!1}})}function N(){a&&(clearTimeout(a),a=null),c(),localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),v.value=!1,S.value="",T.value="",H.value=""}function R(){window.open("/","_blank")}function w(){ee.value=!ee.value}function B(){ee.value=!1}return(L,g)=>v.value?(o(),i("div",eu,[e("aside",{class:E(["admin-sider",{open:ee.value}]),onClick:we(B,["self"])},[e("div",{class:"logo clickable",onClick:g[3]||(g[3]=p=>{t.value="welcome",B()})},"Admin"),e("ul",tu,[e("li",{class:E({active:t.value==="menu"}),onClick:g[4]||(g[4]=p=>{t.value="menu",B()})},"æ ç›®ç®¡ç†",2),e("li",{class:E({active:t.value==="card"}),onClick:g[5]||(g[5]=p=>{t.value="card",B()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:E({active:t.value==="duplicate"}),onClick:g[6]||(g[6]=p=>{t.value="duplicate",B()})},"å»é‡ç®¡ç†",2),e("li",{class:E({active:t.value==="tag"}),onClick:g[7]||(g[7]=p=>{t.value="tag",B()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:E({active:t.value==="promo"}),onClick:g[8]||(g[8]=p=>{t.value="promo",B()})},"å®£ä¼ ç®¡ç†",2),e("li",{class:E({active:t.value==="friend"}),onClick:g[9]||(g[9]=p=>{t.value="friend",B()})},"å‹é“¾ç®¡ç†",2),e("li",{class:E({active:t.value==="user"}),onClick:g[10]||(g[10]=p=>{t.value="user",B()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:E({active:t.value==="backup"}),onClick:g[11]||(g[11]=p=>{t.value="backup",B()})},"å¤‡ä»½ç®¡ç†",2),e("li",{class:E({active:t.value==="ai"}),onClick:g[12]||(g[12]=p=>{t.value="ai",B()})},"AI è®¾ç½®",2)])],2),e("main",su,[e("div",lu,[e("button",{class:"menu-toggle",onClick:w}," â˜° "),e("div",nu,d(te.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:R,title:"è¿›å…¥ä¸»é¡µ"},[...g[17]||(g[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:N},"é€€å‡ºç™»å½•")])]),e("div",au,[_e(Ye,{name:"fade",mode:"out-in"},{default:Xe(()=>[(o(),Ue(Ze(b.value),et({key:t.value},U.value),null,16))]),_:1})]),g[18]||(g[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[z("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(o(),i("div",Od,[e("div",Hd,[g[16]||(g[16]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",jd,[_(e("input",{"onUpdate:modelValue":g[0]||(g[0]=p=>S.value=p),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:xe(se,["enter"])},null,544),[[W,S.value]]),e("div",qd,[_(e("input",{"onUpdate:modelValue":g[1]||(g[1]=p=>T.value=p),type:X.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:xe(se,["enter"])},null,40,Gd),[[Re,T.value]]),e("span",{class:"toggle-password",onClick:g[2]||(g[2]=p=>X.value=!X.value)},[X.value?(o(),i("svg",Jd,[...g[13]||(g[13]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(o(),i("svg",Qd,[...g[14]||(g[14]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",Xd,[e("button",{onClick:R,class:"back-btn"},[...g[15]||(g[15]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),z(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:se,class:"login-btn",disabled:V.value},d(V.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,Yd)]),H.value?(o(),i("p",Zd,d(H.value),1)):A("",!0)])])]))}},uu=J(ou,[["__scopeId","data-v-52d75759"]]);export{uu as default};
